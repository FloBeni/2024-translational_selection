# Pannel 4 A
data13$species = factor(data13$species,levels=data1[order(data1$gci),]$species)
dt_graph = data13[data13$aa_name == "Val",]
count_dinucl = table(dt_graph$trinucl2)
count_dinucl = count_dinucl[order(count_dinucl,decreasing = T)]
dt_graph[dt_graph$trinucl2 == names(count_dinucl[1]),]$trinucl = paste(dt_graph[dt_graph$trinucl2 == names(count_dinucl[1]),]$trinucl,"1",sep="")
vector = unique(paste(dt_graph$codon))
names( vector ) = unique(paste(dt_graph$trinucl))
names(set_color) = c("G1","C1","A1","T1","G","C","A","T")
dt_graph$trinucl = factor(dt_graph$trinucl,levels = c("G1","A1","T1","C1"))
pA = ggplot(dt_graph,aes(x=fpkm,y=rscu,fill=trinucl,col=trinucl)) +geom_line(size=1.5) +
# geom_point(size=3,col="black",pch=21)  +
theme_bw() + theme(
axis.title.x = element_text(color="black", size=30,family="economica",vjust=0),
axis.title.y = element_text(color="black", size=30, family="economica",vjust=1.7),
axis.text.y =  element_text(color="black", size=25, family="economica"),
axis.text.x =  element_text(color="black", size=25, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=30, family="economica",margin = margin(t = 10)),
strip.text = element_text(size=15,face="italic")
)+ xlab("Gene expression level (FPKM, log scale)") +
scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+
scale_alpha_manual("Codons",values=c("CDS"=1,"intronic control"=.5)) +
scale_fill_manual("Codons",values=set_color,label=vector)  +
scale_color_manual("Codons",values=set_color,label=vector) +
scale_shape_manual("Codons",values=c("intronic control"=24,"CDS"=21)) +
guides(fill="none",
color = guide_legend(order = 1,size=30),
linetype = guide_legend(order = 2,size=1),
line = "none",
alpha = "none",
shape = "none"
)   + annotation_logticks(sides = "b")+   facet_wrap(~species) + ylab("RSCU")+labs(fill='Codons',color='Codons',shape='',linetype='')+
guides(fill = guide_legend(order = 1),
color = guide_legend(order = 1,override.aes = list(lwd=4)),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
)
pA
jpeg(paste(path_pannel,"pS11A.jpg",sep=""),  width = 10500/2*0.8,  5400/2,res=600/1.8)
print(pA)
dev.off()
# Figure 4
imgA = load.image(paste(path_pannel,"pS11A.jpg",sep="") )
{
pdf(file= paste(path_figure,"Figure11_supp.pdf",sep=""), width=9*0.8, height=5)
m = matrix(rep(NA,100*100), nrow=100)
m
par(mar=c(1, 1, 2, 0))
plot(imgA, axes=FALSE)
dev.off()
}
pA = ggplot(dt_graph,aes(x=fpkm,y=rscu,fill=trinucl,col=trinucl)) +geom_line(size=1.5) +
# geom_point(size=3,col="black",pch=21)  +
theme_bw() + theme(
axis.title.x = element_text(color="black", size=30,family="economica",vjust=0),
axis.title.y = element_text(color="black", size=30, family="economica",vjust=1.7),
axis.text.y =  element_text(color="black", size=25, family="economica"),
axis.text.x =  element_text(color="black", size=25, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=30, family="economica",margin = margin(t = 10)),
strip.text = element_text(size=15,face="italic")
)+ xlab("Gene expression level (FPKM, log scale)") +
scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+
scale_alpha_manual("Codons",values=c("CDS"=1,"intronic control"=.5)) +
scale_fill_manual("Codons",values=set_color,label=vector)  +
scale_color_manual("Codons",values=set_color,label=vector) +
scale_shape_manual("Codons",values=c("intronic control"=24,"CDS"=21)) +
guides(fill = guide_legend(order = 1),
color = guide_legend(order = 1,override.aes = list(lwd=4)),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
)
pA
pA = ggplot(dt_graph,aes(x=fpkm,y=rscu,fill=trinucl,col=trinucl)) +geom_line(size=1.5) +
# geom_point(size=3,col="black",pch=21)  +
theme_bw() + theme(
axis.title.x = element_text(color="black", size=30,family="economica",vjust=0),
axis.title.y = element_text(color="black", size=30, family="economica",vjust=1.7),
axis.text.y =  element_text(color="black", size=25, family="economica"),
axis.text.x =  element_text(color="black", size=25, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=30, family="economica",margin = margin(t = 10)),
strip.text = element_text(size=15,face="italic")
)+ xlab("Gene expression level (FPKM, log scale)") +
scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+
scale_alpha_manual("Codons",values=c("CDS"=1,"intronic control"=.5)) +
scale_fill_manual("Codons",values=set_color,label=vector)  +
scale_color_manual("Codons",values=set_color,label=vector) +
scale_shape_manual("Codons",values=c("intronic control"=24,"CDS"=21)) +
annotation_logticks(sides = "b")+   facet_wrap(~species) + ylab("RSCU")+labs(fill='Codons',color='Codons',shape='',linetype='')+
guides(fill = guide_legend(order = 1),
color = guide_legend(order = 1,override.aes = list(lwd=4)),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
)
pA
# Generate Figure 4
source("figure/figure_supp_generator/library_path.R")
data1 = read.delim("data/data1_supp.tab")
data1$clade_group = GTDrift_list_species[data1$species,]$clade_group
data1 = data1[ data1$nb_codon_not_decoded == 0  & data1$pval_aa_fpkm < 0.05 & data1$nb_genes_filtered >= 5000 ,]
data1 = data1[data1$clade_group %in% c("Diptera","Lepidoptera"),]
data1 = data1[data1$species != "Eumeta_japonica",]
data1$species = paste(str_replace_all(data1$species,"_"," "),sep="")
data13 = read.delim("data/data13_supp.tab")
data13$species = paste(str_replace_all(data13$species,"_"," "),sep="")
# Pannel 4 A
data13$species = factor(data13$species,levels=data1[order(data1$gci),]$species)
dt_graph = data13[data13$aa_name == "Val",]
count_dinucl = table(dt_graph$trinucl2)
count_dinucl = count_dinucl[order(count_dinucl,decreasing = T)]
dt_graph[dt_graph$trinucl2 == names(count_dinucl[1]),]$trinucl = paste(dt_graph[dt_graph$trinucl2 == names(count_dinucl[1]),]$trinucl,"1",sep="")
vector = unique(paste(dt_graph$codon))
names( vector ) = unique(paste(dt_graph$trinucl))
names(set_color) = c("G1","C1","A1","T1","G","C","A","T")
dt_graph$trinucl = factor(dt_graph$trinucl,levels = c("G1","A1","T1","C1"))
pA = ggplot(dt_graph,aes(x=fpkm,y=rscu,fill=trinucl,col=trinucl)) +geom_line(size=1.5) +
# geom_point(size=3,col="black",pch=21)  +
theme_bw() + theme(
axis.title.x = element_text(color="black", size=30,family="economica",vjust=0),
axis.title.y = element_text(color="black", size=30, family="economica",vjust=1.7),
axis.text.y =  element_text(color="black", size=25, family="economica"),
axis.text.x =  element_text(color="black", size=25, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=30, family="economica",margin = margin(t = 10)),
strip.text = element_text(size=15,face="italic")
)+ xlab("Gene expression level (FPKM, log scale)") +
scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+
scale_alpha_manual("Codons",values=c("CDS"=1,"intronic control"=.5)) +
scale_fill_manual("Codons",values=set_color,label=vector)  +
scale_color_manual("Codons",values=set_color,label=vector) +
scale_shape_manual("Codons",values=c("intronic control"=24,"CDS"=21)) +
annotation_logticks(sides = "b")+   facet_wrap(~species) + ylab("RSCU")+labs(fill='Codons',color='Codons',shape='',linetype='')+
guides(fill = guide_legend(order = 1),
color = guide_legend(order = 1,override.aes = list(lwd=3)),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
)
pA
jpeg(paste(path_pannel,"pS11A.jpg",sep=""),  width = 10500/2*0.8,  5400/2,res=600/1.8)
print(pA)
dev.off()
# Figure 4
imgA = load.image(paste(path_pannel,"pS11A.jpg",sep="") )
{
pdf(file= paste(path_figure,"Figure11_supp.pdf",sep=""), width=9*0.8, height=5)
m = matrix(rep(NA,100*100), nrow=100)
m
par(mar=c(1, 1, 2, 0))
plot(imgA, axes=FALSE)
dev.off()
}
# Generate Figure 4
source("figure/figure_supp_generator/library_path.R")
# Pannel 4 A
data5 = read.delim("data/data5_supp.tab")
data5$gene_set = str_replace_all(data5$gene_set,"all,","genes,")
data5[data5$categorie == "POC-matching triplets (POCMT)",]$categorie = "control"
data5[data5$categorie == "Putative optimal codons (POC)",]$categorie = ""
# dt_graph = data5[ data5$species "Musca_domestica" & data5$set != "POCs",]
dt_graph = data5[  data5$set != "POCs",]
dt_graph$species = paste(str_replace_all(dt_graph$species,"_"," "),sep="")
pA = ggplot(dt_graph ,
aes(x=fpkm ,y=freq*100,fill=paste(set,categorie),col=paste(set,categorie)))  + geom_point(alpha=0)+
geom_line(data=dt_graph,size=2,aes(linetype=paste(set,categorie))) +
# geom_point(data=dt_graph,pch=21,col="black",size=2)+
scale_fill_manual(values=set_color[c(2,1,4,3)]) +
scale_color_manual(values=set_color[c(2,1,4,3)]) +
scale_shape_manual(values=c(21,22,24,23,25,20))+
scale_linetype_manual(values=c("solid","solid","solid","solid"))+
xlab("Gene expression level (FPKM, log scale)") + ylab("Codon frequency (%)") + theme_bw() + theme(
axis.title.x = element_text(color="black", size=25,family="economica",vjust=0),
axis.title.y = element_text(color="black", size=25, family="economica",vjust=2),
axis.text.y =  element_text(color="black", size=23, family="economica"),
axis.text.x =  element_text(color="black", size=20, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica",margin = margin(t = 10)),
strip.text = element_text(size=15,face="italic")
)+labs(fill='Categories',color='Categories',shape='',linetype='')+
guides(fill = guide_legend(override.aes = list(pch=NA),order = 1),
color = guide_legend(order = 1),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
) + scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+ ylim(0.2*100,0.8*100) +
annotation_logticks(sides = "b")+
guides(fill="none",linetype="none",shape="none") +
facet_wrap(~species)
pA
jpeg(paste(path_pannel,"pS9A.jpg",sep=""),  width = 10500/2,  5400/2,res=600/1.8)
print(pA)
dev.off()
# Figure 4
imgA = load.image(paste(path_pannel,"pS9A.jpg",sep="") )
{
pdf(file= paste(path_figure,"Figure9_supp.pdf",sep=""), width=9, height=5)
m = matrix(rep(NA,100*100), nrow=100)
m
par(mar=c(1, 1, 2, 0))
plot(imgA, axes=FALSE)
dev.off()
}
# Generate Figure 4
source("figure/figure_supp_generator/library_path.R")
# Pannel 4 A
data5 = read.delim("data/data5_supp.tab")
data5$gene_set = str_replace_all(data5$gene_set,"all,","genes,")
data5[data5$categorie == "POC-matching triplets (POCMT)",]$categorie = "control"
data5[data5$categorie == "Putative optimal codons (POC)",]$categorie = ""
# dt_graph = data5[ data5$species "Musca_domestica" & data5$set != "POCs",]
dt_graph = data5[  data5$set != "POCs",]
dt_graph$species = paste(str_replace_all(dt_graph$species,"_"," "),sep="")
pA = ggplot(dt_graph ,
aes(x=fpkm ,y=freq*100,fill=paste(set,categorie),col=paste(set,categorie)))  + geom_point(alpha=0)+
geom_line(data=dt_graph,size=2,aes(linetype=paste(set,categorie))) +
# geom_point(data=dt_graph,pch=21,col="black",size=2)+
scale_fill_manual(values=set_color[c(2,1,4,3)]) +
scale_color_manual(values=set_color[c(2,1,4,3)]) +
scale_shape_manual(values=c(21,22,24,23,25,20))+
scale_linetype_manual(values=c("solid","solid","solid","solid"))+
xlab("Gene expression level (FPKM, log scale)") + ylab("Codon frequency (%)") + theme_bw() + theme(
axis.title.x = element_text(color="black", size=25,family="economica",vjust=0),
axis.title.y = element_text(color="black", size=25, family="economica",vjust=2),
axis.text.y =  element_text(color="black", size=23, family="economica"),
axis.text.x =  element_text(color="black", size=20, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica",margin = margin(t = 5)),
strip.text = element_text(size=15,face="italic")
)+labs(fill='Categories',color='Categories',shape='',linetype='')+
guides(fill = guide_legend(override.aes = list(pch=NA),order = 1),
color = guide_legend(order = 1),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
) + scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+ ylim(0.2*100,0.8*100) +
annotation_logticks(sides = "b")+
guides(fill="none",linetype="none",shape="none") +
facet_wrap(~species)
pA
jpeg(paste(path_pannel,"pS9A.jpg",sep=""),  width = 10500/2,  5400/2,res=600/1.8)
print(pA)
dev.off()
# Figure 4
imgA = load.image(paste(path_pannel,"pS9A.jpg",sep="") )
{
pdf(file= paste(path_figure,"Figure9_supp.pdf",sep=""), width=9, height=5)
m = matrix(rep(NA,100*100), nrow=100)
m
par(mar=c(1, 1, 2, 0))
plot(imgA, axes=FALSE)
dev.off()
}
# Generate Figure 4
source("figure/figure_supp_generator/library_path.R")
data1 = read.delim("data/data1_supp.tab")
data1$clade_group = GTDrift_list_species[data1$species,]$clade_group
data1 = data1[ data1$nb_codon_not_decoded == 0  & data1$pval_aa_fpkm < 0.05 & data1$nb_genes_filtered >= 5000 ,]
data1 = data1[data1$clade_group %in% c("Diptera","Lepidoptera"),]
data1 = data1[data1$species != "Eumeta_japonica",]
data1$species = paste(str_replace_all(data1$species,"_"," "),sep="")
data13 = read.delim("data/data13_supp.tab")
data13$species = paste(str_replace_all(data13$species,"_"," "),sep="")
# Pannel 4 A
data13$species = factor(data13$species,levels=data1[order(data1$gci),]$species)
dt_graph = data13[data13$aa_name == "Val",]
count_dinucl = table(dt_graph$trinucl2)
count_dinucl = count_dinucl[order(count_dinucl,decreasing = T)]
dt_graph[dt_graph$trinucl2 == names(count_dinucl[1]),]$trinucl = paste(dt_graph[dt_graph$trinucl2 == names(count_dinucl[1]),]$trinucl,"1",sep="")
vector = unique(paste(dt_graph$codon))
names( vector ) = unique(paste(dt_graph$trinucl))
names(set_color) = c("G1","C1","A1","T1","G","C","A","T")
dt_graph$trinucl = factor(dt_graph$trinucl,levels = c("G1","A1","T1","C1"))
pA = ggplot(dt_graph,aes(x=fpkm,y=rscu,fill=trinucl,col=trinucl)) +geom_line(size=1.5) +
# geom_point(size=3,col="black",pch=21)  +
theme_bw() + theme(
axis.title.x = element_text(color="black", size=30,family="economica",vjust=0),
axis.title.y = element_text(color="black", size=30, family="economica",vjust=1.7),
axis.text.y =  element_text(color="black", size=25, family="economica"),
axis.text.x =  element_text(color="black", size=25, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=30, family="economica",margin = margin(t = 5)),
strip.text = element_text(size=15,face="italic")
)+ xlab("Gene expression level (FPKM, log scale)") +
scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+
scale_alpha_manual("Codons",values=c("CDS"=1,"intronic control"=.5)) +
scale_fill_manual("Codons",values=set_color,label=vector)  +
scale_color_manual("Codons",values=set_color,label=vector) +
scale_shape_manual("Codons",values=c("intronic control"=24,"CDS"=21)) +
annotation_logticks(sides = "b")+   facet_wrap(~species) + ylab("RSCU")+labs(fill='Codons',color='Codons',shape='',linetype='')+
guides(fill = guide_legend(order = 1),
color = guide_legend(order = 1,override.aes = list(lwd=3)),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
)
pA
jpeg(paste(path_pannel,"pS11A.jpg",sep=""),  width = 10500/2*0.8,  5400/2,res=600/1.8)
print(pA)
dev.off()
# Figure 4
imgA = load.image(paste(path_pannel,"pS11A.jpg",sep="") )
{
pdf(file= paste(path_figure,"Figure11_supp.pdf",sep=""), width=9*0.8, height=5)
m = matrix(rep(NA,100*100), nrow=100)
m
par(mar=c(1, 1, 2, 0))
plot(imgA, axes=FALSE)
dev.off()
}
pA = ggplot(dt_graph,aes(x=fpkm,y=rscu,fill=trinucl,col=trinucl)) +geom_line(size=1.5) +
# geom_point(size=3,col="black",pch=21)  +
theme_bw() + theme(
axis.title.x = element_text(color="black", size=30,family="economica",vjust=0),
axis.title.y = element_text(color="black", size=30, family="economica",vjust=1.7),
axis.text.y =  element_text(color="black", size=25, family="economica"),
axis.text.x =  element_text(color="black", size=25, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=30, family="economica",margin = margin(t = 5)),
strip.text = element_text(size=15,face="italic")
)+ xlab("Gene expression level (FPKM, log scale)") +
scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+
scale_alpha_manual("Codons",values=c("CDS"=1,"intronic control"=.5)) +
scale_fill_manual("Codons",values=set_color,label=vector)  +
scale_color_manual("Valine synonymous codons",values=set_color,label=vector) +
scale_shape_manual("Codons",values=c("intronic control"=24,"CDS"=21)) +
annotation_logticks(sides = "b")+   facet_wrap(~species) + ylab("RSCU")+labs(fill='Codons',color='Codons',shape='',linetype='')+
guides(fill = guide_legend(order = 1),
color = guide_legend(order = 1,override.aes = list(lwd=3)),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
)
pA
pA = ggplot(dt_graph,aes(x=fpkm,y=rscu,fill=trinucl,col=trinucl)) +geom_line(size=1.5) +
# geom_point(size=3,col="black",pch=21)  +
theme_bw() + theme(
axis.title.x = element_text(color="black", size=30,family="economica",vjust=0),
axis.title.y = element_text(color="black", size=30, family="economica",vjust=1.7),
axis.text.y =  element_text(color="black", size=25, family="economica"),
axis.text.x =  element_text(color="black", size=25, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=30, family="economica",margin = margin(t = 5)),
strip.text = element_text(size=15,face="italic")
)+ xlab("Gene expression level (FPKM, log scale)") +
scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+
scale_alpha_manual("Codons",values=c("CDS"=1,"intronic control"=.5)) +
scale_fill_manual("Codons",values=set_color,label=vector)  +
scale_color_manual("Valine\nsynonymous codons",values=set_color,label=vector) +
scale_shape_manual("Codons",values=c("intronic control"=24,"CDS"=21)) +
annotation_logticks(sides = "b")+   facet_wrap(~species) + ylab("RSCU")+labs(fill='Codons',color='Codons',shape='',linetype='')+
guides(fill = guide_legend(order = 1),
color = guide_legend(order = 1,override.aes = list(lwd=3)),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
)
pA
# Generate Figure 4
source("figure/figure_supp_generator/library_path.R")
data1 = read.delim("data/data1_supp.tab")
data1$clade_group = GTDrift_list_species[data1$species,]$clade_group
data1 = data1[ data1$nb_codon_not_decoded == 0  & data1$pval_aa_fpkm < 0.05 & data1$nb_genes_filtered >= 5000 ,]
data1 = data1[data1$clade_group %in% c("Diptera","Lepidoptera"),]
data1 = data1[data1$species != "Eumeta_japonica",]
data1$species = paste(str_replace_all(data1$species,"_"," "),sep="")
data13 = read.delim("data/data13_supp.tab")
data13$species = paste(str_replace_all(data13$species,"_"," "),sep="")
# Pannel 4 A
data13$species = factor(data13$species,levels=data1[order(data1$gci),]$species)
dt_graph = data13[data13$aa_name == "Val",]
count_dinucl = table(dt_graph$trinucl2)
count_dinucl = count_dinucl[order(count_dinucl,decreasing = T)]
dt_graph[dt_graph$trinucl2 == names(count_dinucl[1]),]$trinucl = paste(dt_graph[dt_graph$trinucl2 == names(count_dinucl[1]),]$trinucl,"1",sep="")
vector = unique(paste(dt_graph$codon))
names( vector ) = unique(paste(dt_graph$trinucl))
names(set_color) = c("G1","C1","A1","T1","G","C","A","T")
dt_graph$trinucl = factor(dt_graph$trinucl,levels = c("G1","A1","T1","C1"))
pA = ggplot(dt_graph,aes(x=fpkm,y=rscu,fill=trinucl,col=trinucl)) +geom_line(size=1.5) +
# geom_point(size=3,col="black",pch=21)  +
theme_bw() + theme(
axis.title.x = element_text(color="black", size=30,family="economica",vjust=0),
axis.title.y = element_text(color="black", size=30, family="economica",vjust=1.7),
axis.text.y =  element_text(color="black", size=25, family="economica"),
axis.text.x =  element_text(color="black", size=25, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=30, family="economica",margin = margin(t = 5)),
strip.text = element_text(size=15,face="italic")
)+ xlab("Gene expression level (FPKM, log scale)") +
scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+
scale_alpha_manual("Codons",values=c("CDS"=1,"intronic control"=.5)) +
scale_fill_manual("Codons",values=set_color,label=vector)  +
scale_color_manual("Valine\nsynonymous codons",values=set_color,label=vector) +
scale_shape_manual("Codons",values=c("intronic control"=24,"CDS"=21)) +
annotation_logticks(sides = "b")+   facet_wrap(~species) + ylab("RSCU")+labs(fill='Codons',color='Codons',shape='',linetype='')+
guides(fill = guide_legend(order = 1),
color = guide_legend(order = 1,override.aes = list(lwd=3)),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
)
pA
jpeg(paste(path_pannel,"pS11A.jpg",sep=""),  width = 10500/2*0.8,  5400/2,res=600/1.8)
print(pA)
dev.off()
# Figure 4
imgA = load.image(paste(path_pannel,"pS11A.jpg",sep="") )
{
pdf(file= paste(path_figure,"Figure11_supp.pdf",sep=""), width=9*0.8, height=5)
m = matrix(rep(NA,100*100), nrow=100)
m
par(mar=c(1, 1, 2, 0))
plot(imgA, axes=FALSE)
dev.off()
}
pA = ggplot(dt_graph,aes(x=fpkm,y=rscu,fill=trinucl,col=trinucl)) +geom_line(size=1.5) +
# geom_point(size=3,col="black",pch=21)  +
theme_bw() + theme(
axis.title.x = element_text(color="black", size=30,family="economica",vjust=0),
axis.title.y = element_text(color="black", size=30, family="economica",vjust=1.7),
axis.text.y =  element_text(color="black", size=25, family="economica"),
axis.text.x =  element_text(color="black", size=25, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=30, family="economica",margin = margin(t = 5)),
strip.text = element_text(size=15,face="italic")
)+ xlab("Gene expression level (FPKM, log scale)") +
scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+
scale_alpha_manual("Codons",values=c("CDS"=1,"intronic control"=.5)) +
scale_fill_manual("Codons",values=set_color,label=vector)  +
scale_color_manual("Valine\nsynonymous\ncodons",values=set_color,label=vector) +
scale_shape_manual("Codons",values=c("intronic control"=24,"CDS"=21)) +
annotation_logticks(sides = "b")+   facet_wrap(~species) + ylab("RSCU")+labs(fill='Codons',color='Codons',shape='',linetype='')+
guides(fill = guide_legend(order = 1),
color = guide_legend(order = 1,override.aes = list(lwd=3)),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
)
pA
# Generate Figure 4
source("figure/figure_supp_generator/library_path.R")
data1 = read.delim("data/data1_supp.tab")
data1$clade_group = GTDrift_list_species[data1$species,]$clade_group
data1 = data1[ data1$nb_codon_not_decoded == 0  & data1$pval_aa_fpkm < 0.05 & data1$nb_genes_filtered >= 5000 ,]
data1 = data1[data1$clade_group %in% c("Diptera","Lepidoptera"),]
data1 = data1[data1$species != "Eumeta_japonica",]
data1$species = paste(str_replace_all(data1$species,"_"," "),sep="")
data13 = read.delim("data/data13_supp.tab")
data13$species = paste(str_replace_all(data13$species,"_"," "),sep="")
# Pannel 4 A
data13$species = factor(data13$species,levels=data1[order(data1$gci),]$species)
dt_graph = data13[data13$aa_name == "Val",]
count_dinucl = table(dt_graph$trinucl2)
count_dinucl = count_dinucl[order(count_dinucl,decreasing = T)]
dt_graph[dt_graph$trinucl2 == names(count_dinucl[1]),]$trinucl = paste(dt_graph[dt_graph$trinucl2 == names(count_dinucl[1]),]$trinucl,"1",sep="")
vector = unique(paste(dt_graph$codon))
names( vector ) = unique(paste(dt_graph$trinucl))
names(set_color) = c("G1","C1","A1","T1","G","C","A","T")
dt_graph$trinucl = factor(dt_graph$trinucl,levels = c("G1","A1","T1","C1"))
pA = ggplot(dt_graph,aes(x=fpkm,y=rscu,fill=trinucl,col=trinucl)) +geom_line(size=1.5) +
# geom_point(size=3,col="black",pch=21)  +
theme_bw() + theme(
axis.title.x = element_text(color="black", size=30,family="economica",vjust=0),
axis.title.y = element_text(color="black", size=30, family="economica",vjust=1.7),
axis.text.y =  element_text(color="black", size=25, family="economica"),
axis.text.x =  element_text(color="black", size=25, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=30, family="economica",margin = margin(t = 5)),
strip.text = element_text(size=15,face="italic")
)+ xlab("Gene expression level (FPKM, log scale)") +
scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+
scale_alpha_manual("Codons",values=c("CDS"=1,"intronic control"=.5)) +
scale_fill_manual("Codons",values=set_color,label=vector)  +
scale_color_manual("Valine\nsynonymous\ncodons",values=set_color,label=vector) +
scale_shape_manual("Codons",values=c("intronic control"=24,"CDS"=21)) +
annotation_logticks(sides = "b")+   facet_wrap(~species) + ylab("RSCU")+labs(fill='Codons',color='Codons',shape='',linetype='')+
guides(fill = guide_legend(order = 1),
color = guide_legend(order = 1,override.aes = list(lwd=3)),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
)
pA
jpeg(paste(path_pannel,"pS11A.jpg",sep=""),  width = 10500/2*0.8,  5400/2,res=600/1.8)
print(pA)
dev.off()
# Figure 4
imgA = load.image(paste(path_pannel,"pS11A.jpg",sep="") )
{
pdf(file= paste(path_figure,"Figure11_supp.pdf",sep=""), width=9*0.8, height=5)
m = matrix(rep(NA,100*100), nrow=100)
m
par(mar=c(1, 1, 2, 0))
plot(imgA, axes=FALSE)
dev.off()
}
