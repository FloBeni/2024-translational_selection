ylab(expression(paste(italic("N"[e])))) +
scale_x_log10(breaks=c(0.01,0.1,1,10,100,1000,5000),labels=c(0.01,0.1,1,10,100,1000,5000)) + xlab("Body length (cm, log scale)")+
annotation_logticks(sides="lb")  + scale_y_log10() + guides(fill = guide_legend(override.aes = list(size=5,pch=21)),
shape = guide_legend(override.aes = list(fill="black"))) +
scale_y_log10(labels=label_log(digits = 2))
pB
jpeg(paste(path_pannel,"p7B.jpg",sep=""),width = 4200/2, height = 4000/2,res=700/2)
print(pB)
dev.off()
# Pannel 7 C
dt_graph = data1
ylabel = "Ne"
xlabel = "Mass_Lynch"
dt_graph = dt_graph[!is.na(dt_graph[,xlabel]) & !is.na(dt_graph[,ylabel]) & dt_graph$species %in% arbrePhylo$tip.label,]
model_to_use = fitted_model(x=log10(dt_graph[,xlabel]),y=log10(dt_graph[,ylabel]),label=dt_graph$species,tree=arbrePhylo,display_other=F,pagels_obliged=T)
pC =  ggplot(dt_graph,aes_string(y=ylabel,x=xlabel,shape="Mass_Lynch_estimate"))   +
geom_abline(lwd=1,slope = model_to_use$slope, intercept = model_to_use$intercept)+
geom_point(aes(fill=clade_group),size=4,alpha=.8) + theme_bw() + theme(
axis.title.x = element_text(color="black", size=26,family="economica"),
axis.title.y = element_text(color="black", size=26, family="economica"),
axis.text.y =  element_text(color="black", size=24, family="economica"),
axis.text.x =  element_text(color="black", size=24, family="economica"),
title =  element_text(color="black", size=20, family="economica"),
text =  element_text(color="black", size=31, family="economica"),
legend.text =  element_text(color="black", size=24, family="economica",vjust = 1.5,margin = margin(t = 10)),
plot.caption = element_text(hjust = 0.5, face= "italic", size=20, family="economica"),
plot.caption.position =  "plot"
)+ guides(fill = guide_legend(override.aes = list(size=5))) +
labs(
caption = substitute(paste(model,lambda," :",aic," R"^2,"= ",r2,", p-value ",pvalue,model_non_opti,
"; LM"," : R"^2,"= ",LMr2,", p-value = ",LMpval), model_to_use),
title = paste("N = ",nrow(dt_graph)," species",sep="")
) + scale_fill_manual("Clades",values=Clade_color) + scale_shape_manual(expression(paste(italic("N"[e])," estimates")),values=c(24,21)) +
ylab(expression(paste(italic("N"[e])))) +   theme(legend.position="none")+ xlab("Body mass (kg, log scale)")+
scale_x_log10(breaks=c(10^-12,10^-8,10^-4,10^0,10^4,10^6),labels=label_log(digits = 2),limits = c(0.00000000001,10000)) +
annotation_logticks(sides="lb")  + scale_y_log10() + guides(fill = guide_legend(override.aes = list(size=5,pch=21)),
shape = guide_legend(override.aes = list(fill="black"))) +
scale_y_log10(labels=label_log(digits = 2))
pC
jpeg(paste(path_pannel,"p7C.jpg",sep=""),width = 4200/2, height = 4000/2,res=700/2)
print(pC)
dev.off()
# Pannel 7 D
dt_graph = data1
ylabel = "Ne"
xlabel = "dNdS"
dt_graph = dt_graph[!is.na(dt_graph[,xlabel]) & !is.na(dt_graph[,ylabel]) & dt_graph$species %in% arbrePhylo$tip.label,]
model_to_use = fitted_model(x=log10(dt_graph[,xlabel]),y=log10(dt_graph[,ylabel]),label=dt_graph$species,tree=arbrePhylo,display_other=F,pagels_obliged=T)
pD = ggplot(dt_graph,aes_string(y=ylabel,x=xlabel,shape="Ne_estimate"))   +
geom_abline(lwd=1,slope = model_to_use$slope, intercept = model_to_use$intercept)+
geom_point(aes(fill=clade_group),size=4,alpha=.8) + theme_bw() + theme(
axis.title.x = element_text(color="black", size=26,family="economica"),
axis.title.y = element_text(color="black", size=26, family="economica"),
axis.text.y =  element_text(color="black", size=24, family="economica"),
axis.text.x =  element_text(color="black", size=24, family="economica"),
title =  element_text(color="black", size=20, family="economica"),
text =  element_text(color="black", size=31, family="economica"),
legend.text =  element_text(color="black", size=24, family="economica",vjust = 1.5,margin = margin(t = 10)),
plot.caption = element_text(hjust = 0.6, face= "italic", size=20, family="economica"),
plot.caption.position =  "plot"
)+ guides(fill = guide_legend(override.aes = list(size=5))) + theme(legend.position="none")+
labs(
caption = substitute(paste(model,lambda," :",aic," R"^2,"= ",r2,", p-value ",pvalue,model_non_opti,
"; LM"," : R"^2,"= ",LMr2,", p-value = ",LMpval), model_to_use),
title = paste("N = ",nrow(dt_graph)," species",sep="")
) + scale_fill_manual(values=Clade_color) + scale_shape_manual(expression(paste(italic("N"[e])," estimates")),values=c(24,21)) +
ylab(expression(paste(italic("N"[e])))) + xlab("dN/dS (log scale)") + scale_x_log10()+ annotation_logticks(sides="lb")  +
scale_y_log10() + guides(fill = guide_legend(override.aes = list(size=5,pch=21)),
shape = guide_legend(override.aes = list(fill="black"))) +
scale_y_log10(labels=label_log(digits = 2))
pD
jpeg(paste(path_pannel,"p7D.jpg",sep=""),width = 4200/2, height = 4000/2,res=700/2)
print(pD)
dev.off()
# Supplementary Figure 10
imgA = load.image(paste(path_pannel,"p7A.jpg",sep="") )
imgB = load.image(paste(path_pannel,"p7B.jpg",sep="") )
imgC = load.image(paste(path_pannel,"p7C.jpg",sep="") )
imgD = load.image(paste(path_pannel,"p7D.jpg",sep="") )
{
pdf(file=paste(path_figure,"Figure10_supp.pdf",sep=""), width=10, height=8)
m = matrix(rep(NA,2*100), nrow=2)
m[1,]=c(rep(1,60),rep(2,40))
m[2,]=c(rep(3,50),rep(4,50))
layout(m)
par(mar=c(0,0, 2, 0))
plot(imgA, axes=FALSE)
mtext("A",at=0,adj=-1, side=2, line=1, font=2, cex=2,las=2)
plot(imgB, axes=FALSE)
mtext("B",at=0,adj=0, side=2, line=1, font=2, cex=2,las=2)
plot(imgC, axes=FALSE)
mtext("C",at=0,adj=-1, side=2, line=1, font=2, cex=2,las=2)
plot(imgD, axes=FALSE)
mtext("D",at=0,adj=-1, side=2, line=1, font=2, cex=2,las=2)
dev.off()
}
# Generate Supplementary Figure 10
source("figure/figure_supp_generator/library_path.R")
resolution=2
lynch_dt = read.table("data/Lynch2023_embr202357561-sup-0002-metazoa.csv",header=T,sep="\t",dec=",")
lynch_dt$species = str_replace_all(lynch_dt$Species," ","_")
lynch_dt$species = sapply(lynch_dt$species ,function(x) paste(str_split_1(x,"_")[1],str_split_1(x,"_")[2],sep="_"))
lynch_dt$genus = sapply(lynch_dt$species ,function(x) str_split_1(x,"_")[1])
rownames(lynch_dt) = lynch_dt$species
lynch_dt$mass = as.numeric(lynch_dt$Dry.Mass.at.Maturity...kg.)
Ne_genus = tapply(lynch_dt$Ne,lynch_dt$genus,mean)
mass_genus = tapply(lynch_dt$mass,lynch_dt$genus,function(x) mean(x,na.rm=T))
data1 = read.delim("data/data1_supp.tab")
data1$Ne = lynch_dt[data1$species,]$Ne
data1$Ne_estimate = "from genus"
data1[!is.na(data1$Ne),]$Ne_estimate = "from species"
data1[is.na(data1$Ne),]$Ne = Ne_genus[sapply(data1[is.na(data1$Ne),]$species ,function(x) str_split_1(x,"_")[1])]
data1[is.na(data1$Ne),]$Ne_estimate = ""
data1$Mass_Lynch = lynch_dt[data1$species,]$mass
data1$Mass_Lynch_estimate = "from genus"
data1[!is.na(data1$Mass_Lynch),]$Mass_Lynch_estimate = "from species"
data1[is.na(data1$Mass_Lynch),]$Mass_Lynch = mass_genus[sapply(data1[is.na(data1$Mass_Lynch),]$species ,function(x) str_split_1(x,"_")[1])]
data1[is.na(data1$Mass_Lynch),]$Mass_Lynch_estimate = ""
data1$clade_group = GTDrift_list_species[data1$species,]$clade_group
# data1 = data1[ data1$nb_codon_not_decoded == 0  & data1$pval_aa_fpkm < 0.05 & data1$nb_genes_filtered >= 5000 ,]
data1[,c("lifespan_days","length_cm","weight_kg")] = GTDrift_list_species[data1$species,c("lifespan_days","length_cm","weight_kg")]
dnds = read.delim("data/GTDrift_Metazoa_dNdS.tab")
rownames(dnds) = dnds$species
data1[,c("dNdS")] = dnds[data1$species,c("dNdS")]
# Pannel 7 A
dt_graph = data1
ylabel = "Ne"
xlabel = "lifespan_days"
dt_graph = dt_graph[!is.na(dt_graph[,xlabel]) & !is.na(dt_graph[,ylabel]) & dt_graph$species %in% arbrePhylo$tip.label,]
model_to_use = fitted_model(x=log10(dt_graph[,xlabel]),y=log10(dt_graph[,ylabel]),
label=dt_graph$species,tree=arbrePhylo,display_other=F,pagels_obliged=T)
pA =  ggplot(dt_graph,aes_string(y=ylabel,x=xlabel,shape="Ne_estimate"))  +
geom_abline(lwd=1,slope = model_to_use$slope, intercept = model_to_use$intercept) +
geom_point(aes(fill=clade_group),size=4,alpha=.7) + theme_bw() + theme(
axis.title.x = element_text(color="black", size=28,family="economica"),
axis.title.y = element_text(color="black", size=28, family="economica"),
axis.text.y =  element_text(color="black", size=26, family="economica"),
axis.text.x =  element_text(color="black", size=26, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
text =  element_text(color="black", size=31, family="economica"),
legend.text =  element_text(color="black", size=22, family="economica",vjust = 1.5,margin = margin(t = 10)),
plot.caption = element_text(hjust = 0.35, face= "italic", size=20, family="economica"),
plot.caption.position =  "plot"
)+ guides(fill = guide_legend(override.aes = list(size=5))) +
labs(
caption = substitute(paste(model,lambda," :",aic," R"^2,"= ",r2,", p-value ",pvalue,model_non_opti,
"; LM"," : R"^2,"= ",LMr2,", p-value = ",LMpval), model_to_use),
title = paste("N = ",nrow(dt_graph)," species",sep="")
)+ scale_fill_manual("Clades",values=Clade_color) + scale_shape_manual(expression(paste(italic("N"[e])," estimates")),values=c(24,21)) +
ylab(expression(paste(italic("N"[e])))) +
scale_x_log10(breaks=c(0.05,0.1,0.5,1,5,10,100,1000,10000),labels=c(0.05,0.1,0.5,1,5,10,100,1000,10000)) +
xlab("Longevity (days, log scale)")+
guides(fill = guide_legend(byrow = TRUE,override.aes = list(size=5,pch=21)),
shape = guide_legend(byrow = TRUE,override.aes = list(fill="black")))  +
theme(legend.spacing.y = unit(-.1, 'cm'))  +
scale_y_log10(labels=label_log(digits = 2))  +annotation_logticks(sides="lb")
pA
jpeg(paste(path_pannel,"p7A.jpg",sep=""), width = 9000/resolution, height = 6000/resolution,res=1000/resolution)
print(pA)
dev.off()
# Pannel 7 B
dt_graph = data1
ylabel = "Ne"
xlabel = "length_cm"
dt_graph = dt_graph[!is.na(dt_graph[,xlabel]) & !is.na(dt_graph[,ylabel]) & dt_graph$species %in% arbrePhylo$tip.label,]
model_to_use = fitted_model(x=log10(dt_graph[,xlabel]),y=log10(dt_graph[,ylabel]),label=dt_graph$species,tree=arbrePhylo,display_other=F,pagels_obliged=T)
pB = ggplot(dt_graph,aes_string(y=ylabel,x=xlabel,shape="Ne_estimate"))    +
geom_abline(lwd=1,slope = model_to_use$slope, intercept = model_to_use$intercept)+
geom_point(aes(fill=clade_group),size=4,alpha=.7) + theme_bw() + theme(
axis.title.x = element_text(color="black", size=26,family="economica"),
axis.title.y = element_text(color="black", size=26, family="economica"),
axis.text.y =  element_text(color="black", size=24, family="economica"),
axis.text.x =  element_text(color="black", size=24, family="economica"),
title =  element_text(color="black", size=20, family="economica"),
text =  element_text(color="black", size=31, family="economica"),
legend.text =  element_text(color="black", size=24, family="economica",vjust = 1.5,margin = margin(t = 10)),
plot.caption = element_text(hjust = 0.6, face= "italic", size=20, family="economica"),
plot.caption.position =  "plot"
)+ guides(fill = guide_legend(override.aes = list(size=5))) + theme(legend.position="none")+
labs(
caption = substitute(paste(model,lambda," :",aic," R"^2,"= ",r2,", p-value ",pvalue,model_non_opti,
"; LM"," : R"^2,"= ",LMr2,", p-value = ",LMpval), model_to_use),
title = paste("N = ",nrow(dt_graph)," species",sep="")
) + scale_fill_manual(values=Clade_color) + scale_shape_manual(expression(paste(italic("N"[e])," estimates")),values=c(24,21)) +
ylab(expression(paste(italic("N"[e])))) +
scale_x_log10(breaks=c(0.01,0.1,1,10,100,1000,5000),labels=c(0.01,0.1,1,10,100,1000,5000)) + xlab("Body length (cm, log scale)")+
annotation_logticks(sides="lb")  + scale_y_log10() + guides(fill = guide_legend(override.aes = list(size=5,pch=21)),
shape = guide_legend(override.aes = list(fill="black"))) +
scale_y_log10(labels=label_log(digits = 2))
pB
jpeg(paste(path_pannel,"p7B.jpg",sep=""),width = 4200/2, height = 4000/2,res=700/2)
print(pB)
dev.off()
# Pannel 7 C
dt_graph = data1
ylabel = "Ne"
xlabel = "Mass_Lynch"
dt_graph = dt_graph[!is.na(dt_graph[,xlabel]) & !is.na(dt_graph[,ylabel]) & dt_graph$species %in% arbrePhylo$tip.label,]
model_to_use = fitted_model(x=log10(dt_graph[,xlabel]),y=log10(dt_graph[,ylabel]),label=dt_graph$species,tree=arbrePhylo,display_other=F,pagels_obliged=T)
pC =  ggplot(dt_graph,aes_string(y=ylabel,x=xlabel,shape="Mass_Lynch_estimate"))   +
geom_abline(lwd=1,slope = model_to_use$slope, intercept = model_to_use$intercept)+
geom_point(aes(fill=clade_group),size=4,alpha=.7) + theme_bw() + theme(
axis.title.x = element_text(color="black", size=26,family="economica"),
axis.title.y = element_text(color="black", size=26, family="economica"),
axis.text.y =  element_text(color="black", size=24, family="economica"),
axis.text.x =  element_text(color="black", size=24, family="economica"),
title =  element_text(color="black", size=20, family="economica"),
text =  element_text(color="black", size=31, family="economica"),
legend.text =  element_text(color="black", size=24, family="economica",vjust = 1.5,margin = margin(t = 10)),
plot.caption = element_text(hjust = 0.5, face= "italic", size=20, family="economica"),
plot.caption.position =  "plot"
)+ guides(fill = guide_legend(override.aes = list(size=5))) +
labs(
caption = substitute(paste(model,lambda," :",aic," R"^2,"= ",r2,", p-value ",pvalue,model_non_opti,
"; LM"," : R"^2,"= ",LMr2,", p-value = ",LMpval), model_to_use),
title = paste("N = ",nrow(dt_graph)," species",sep="")
) + scale_fill_manual("Clades",values=Clade_color) + scale_shape_manual(expression(paste(italic("N"[e])," estimates")),values=c(24,21)) +
ylab(expression(paste(italic("N"[e])))) +   theme(legend.position="none")+ xlab("Body mass (kg, log scale)")+
scale_x_log10(breaks=c(10^-12,10^-8,10^-4,10^0,10^4,10^6),labels=label_log(digits = 2),limits = c(0.00000000001,10000)) +
annotation_logticks(sides="lb")  + scale_y_log10() + guides(fill = guide_legend(override.aes = list(size=5,pch=21)),
shape = guide_legend(override.aes = list(fill="black"))) +
scale_y_log10(labels=label_log(digits = 2))
pC
jpeg(paste(path_pannel,"p7C.jpg",sep=""),width = 4200/2, height = 4000/2,res=700/2)
print(pC)
dev.off()
# Pannel 7 D
dt_graph = data1
ylabel = "Ne"
xlabel = "dNdS"
dt_graph = dt_graph[!is.na(dt_graph[,xlabel]) & !is.na(dt_graph[,ylabel]) & dt_graph$species %in% arbrePhylo$tip.label,]
model_to_use = fitted_model(x=log10(dt_graph[,xlabel]),y=log10(dt_graph[,ylabel]),label=dt_graph$species,tree=arbrePhylo,display_other=F,pagels_obliged=T)
pD = ggplot(dt_graph,aes_string(y=ylabel,x=xlabel,shape="Ne_estimate"))   +
geom_abline(lwd=1,slope = model_to_use$slope, intercept = model_to_use$intercept)+
geom_point(aes(fill=clade_group),size=4,alpha=.7) + theme_bw() + theme(
axis.title.x = element_text(color="black", size=26,family="economica"),
axis.title.y = element_text(color="black", size=26, family="economica"),
axis.text.y =  element_text(color="black", size=24, family="economica"),
axis.text.x =  element_text(color="black", size=24, family="economica"),
title =  element_text(color="black", size=20, family="economica"),
text =  element_text(color="black", size=31, family="economica"),
legend.text =  element_text(color="black", size=24, family="economica",vjust = 1.5,margin = margin(t = 10)),
plot.caption = element_text(hjust = 0.6, face= "italic", size=20, family="economica"),
plot.caption.position =  "plot"
)+ guides(fill = guide_legend(override.aes = list(size=5))) + theme(legend.position="none")+
labs(
caption = substitute(paste(model,lambda," :",aic," R"^2,"= ",r2,", p-value ",pvalue,model_non_opti,
"; LM"," : R"^2,"= ",LMr2,", p-value = ",LMpval), model_to_use),
title = paste("N = ",nrow(dt_graph)," species",sep="")
) + scale_fill_manual(values=Clade_color) + scale_shape_manual(expression(paste(italic("N"[e])," estimates")),values=c(24,21)) +
ylab(expression(paste(italic("N"[e])))) + xlab("dN/dS (log scale)") + scale_x_log10()+ annotation_logticks(sides="lb")  +
scale_y_log10() + guides(fill = guide_legend(override.aes = list(size=5,pch=21)),
shape = guide_legend(override.aes = list(fill="black"))) +
scale_y_log10(labels=label_log(digits = 2))
pD
jpeg(paste(path_pannel,"p7D.jpg",sep=""),width = 4200/2, height = 4000/2,res=700/2)
print(pD)
dev.off()
# Supplementary Figure 10
imgA = load.image(paste(path_pannel,"p7A.jpg",sep="") )
imgB = load.image(paste(path_pannel,"p7B.jpg",sep="") )
imgC = load.image(paste(path_pannel,"p7C.jpg",sep="") )
imgD = load.image(paste(path_pannel,"p7D.jpg",sep="") )
{
pdf(file=paste(path_figure,"Figure10_supp.pdf",sep=""), width=10, height=8)
m = matrix(rep(NA,2*100), nrow=2)
m[1,]=c(rep(1,60),rep(2,40))
m[2,]=c(rep(3,50),rep(4,50))
layout(m)
par(mar=c(0,0, 2, 0))
plot(imgA, axes=FALSE)
mtext("A",at=0,adj=-1, side=2, line=1, font=2, cex=2,las=2)
plot(imgB, axes=FALSE)
mtext("B",at=0,adj=0, side=2, line=1, font=2, cex=2,las=2)
plot(imgC, axes=FALSE)
mtext("C",at=0,adj=-1, side=2, line=1, font=2, cex=2,las=2)
plot(imgD, axes=FALSE)
mtext("D",at=0,adj=-1, side=2, line=1, font=2, cex=2,las=2)
dev.off()
}
# Generate Supplementary Figure 3
source("figure/figure_supp_generator/library_path.R")
# Supplementary Pannel 3 A
data1 = read.delim("data/data1_supp.tab")
data1$clade_group = GTDrift_list_species[data1$species,]$clade_group
data1 = data1[ data1$nb_codon_not_decoded == 0 & data1$pval_aa_fpkm < 0.05  & data1$nb_genes_filtered > 5000,]
dt_graph = data1
ylabel = "expressed_overused_background_POCs"
xlabel = "expressed_overused_POCs"
dt_graph = dt_graph[!is.na(dt_graph[,xlabel]) & !is.na(dt_graph[,ylabel]) & dt_graph$species %in% arbrePhylo$tip.label,]
model_to_use = fitted_model(x=dt_graph[,xlabel],y=dt_graph[,ylabel],label=dt_graph$species,tree=arbrePhylo,display_other=F,pagels_obliged=T)
pA =  ggplot(dt_graph,aes_string(y=ylabel,x=xlabel))  +
geom_abline(linetype="dashed") +
geom_hline(size=1,linetype="dashed",col="red", yintercept = 0 ) +
geom_vline(size=1,linetype="dashed",col="red", xintercept = 0 ) +
geom_abline(lwd=1,slope = model_to_use$slope, intercept = model_to_use$intercept)+
geom_point(aes(fill=clade_group),size=4,pch=21,alpha=.7) + theme_bw() + theme(
axis.title.x = element_text(color="black", size=26,family="economica"),
axis.title.y = element_text(color="black", size=26, family="economica",margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.text.y =  element_text(color="black", size=24, family="economica"),
axis.text.x =  element_text(color="black", size=24, family="economica"),
title =  element_text(color="black", size=20, family="economica"),
text =  element_text(color="black", size=31, family="economica"),
legend.text =  element_text(color="black", size=24, family="economica",vjust = 1.5,margin = margin(t = 10)),
legend.title =  element_text(color="black", size=25, family="economica"),
plot.caption = element_text(hjust = 0.4, face= "italic", size=20, family="economica"),
plot.caption.position =  "plot"
)+ guides(fill = guide_legend(override.aes = list(size=5)))+
labs(
caption = substitute(paste(model," :",aic," R"^2,"= ",r2,", p-value ",pvalue,model_non_opti), model_to_use),
title = paste("N = ",nrow(dt_graph)," species",sep="")
) + scale_fill_manual("Clades",values=Clade_color) + xlab(substitute(paste(Delta," POC"^"exp",", not accounting for intron control")))  + ylab(substitute(paste(Delta," POC"^"exp")))
pA
jpeg(paste(path_pannel,"p3A_supp.jpg",sep=""), width = 4500/1, height = 3000/1,res=400/1)
print(pA)
dev.off()
# Supplementary Figure 3
imgA = load.image(paste(path_pannel,"p3A_supp.jpg",sep="") )
{
pdf(file= paste(path_figure,"Figure5_supp.pdf",sep=""), width=6, height=4)
par(mar=c(0, 2, 0, 0))
plot(imgA, axes=FALSE)
dev.off()
}
# Generate Supplementary Figure 2
source("figure/figure_supp_generator/library_path.R")
# Supplementary Pannel 2 A
data1_supp = read.delim("data/data7_supp.tab")
dt_graph = data1_supp[data1_supp$species == "Drosophila_melanogaster",]
spearman_method_aa = cor.test( dt_graph$prop_abundance_average, dt_graph$prop_transcriptome_count,method="spearman",exact=F)
pA=ggplot(dt_graph,aes(x = prop_transcriptome_count*100 , y = prop_abundance_average*100)) + geom_smooth(method='lm',linetype='dashed',se=F, formula= y~x,col=set_color[3],size=2) +
geom_point(pch=21,fill=set_color[4],size=4) +
ylab("tRNA abundance (%)") + xlab("Amino-acid frequency (%)") +
theme_bw() + theme(
axis.title.x = element_text(color="black", size=26,family="economica"),
axis.title.y = element_text(color="black", size=26, family="economica"),
axis.text.y =  element_text(color="black", size=20, family="economica"),
axis.text.x =  element_text(color="black", size=20, family="economica"),
title =  element_text(color="black", size=20, family="economica"),
text =  element_text(color="black", size=31, family="economica"),
legend.text =  element_text(color="black", size=24, family="economica",vjust = 1.5,margin = margin(t = 10)),
plot.caption = element_text(hjust = 0.55, face= "italic", size=20, family="economica"),
plot.caption.position =  "plot"
) +
labs(
caption = substitute(paste("rho = ",rho_aa_fpkm,", p-value = ",pval_aa_fpkm), list(
rho_aa_fpkm = round(spearman_method_aa$estimate, 2),
pval_aa_fpkm = formatC(spearman_method_aa$p.value, format = "e", digits = 0)))
)
pA
jpeg(paste(path_pannel,"p2A_supp.jpg",sep=""), width = 4000/1, height = 2500/1,res=550/1)
print(pA)
dev.off()
# Supplementary Pannel 2 B
dt_graph = data1_supp[data1_supp$species == "Homo_sapiens",]
spearman_method_aa = cor.test( dt_graph$prop_abundance_average, dt_graph$prop_transcriptome_count,method="spearman",exact=F)
pB=ggplot(dt_graph,aes(x=prop_transcriptome_count*100,y=prop_abundance_average*100)) + geom_smooth(method='lm',linetype='dashed',se=F, formula= y~x,col=set_color[1],size=2) +
geom_point(pch=21,fill=set_color[2],size=4) +
ylab("tRNA abundance (%)")+ xlab("Amino-acid frequency (%)") +
theme_bw() + theme(
axis.title.x = element_text(color="black", size=26,family="economica"),
axis.title.y = element_text(color="black", size=26, family="economica"),
axis.text.y =  element_text(color="black", size=20, family="economica"),
axis.text.x =  element_text(color="black", size=20, family="economica"),
title =  element_text(color="black", size=20, family="economica"),
text =  element_text(color="black", size=31, family="economica"),
legend.text =  element_text(color="black", size=24, family="economica",vjust = 1.5,margin = margin(t = 10)),
plot.caption = element_text(hjust = 0.55, face= "italic", size=20, family="economica"),
plot.caption.position =  "plot"
) +
labs(
caption = substitute(paste("rho = ",rho_aa_fpkm,", p-value = ",pval_aa_fpkm), list(
rho_aa_fpkm = round(spearman_method_aa$estimate, 2),
pval_aa_fpkm = formatC(spearman_method_aa$p.value, format = "e", digits = 0)))
)
pB
jpeg(paste(path_pannel,"p2B_supp.jpg",sep=""), width = 4000/1, height = 2500/1,res=550/1)
print(pB)
dev.off()
# Supplementary Pannel 2 C
dt_graph = data1_supp[data1_supp$species == "Drosophila_melanogaster",]
spearman_method_aa = cor.test( dt_graph$gene_copies, dt_graph$prop_transcriptome_count,method="spearman",exact=F)
pC=ggplot(dt_graph,aes(x=prop_transcriptome_count*100,y=gene_copies)) + geom_smooth(method='lm',linetype='dashed',se=F, formula= y~x,col=set_color[3],size=2) +
geom_point(pch=21,fill=set_color[4],size=4) +
xlab("Amino-acid frequency (%)") + ylab("Gene copy number") +
theme_bw() + theme(
axis.title.x = element_text(color="black", size=26,family="economica"),
axis.title.y = element_text(color="black", size=26, family="economica"),
axis.text.y =  element_text(color="black", size=20, family="economica"),
axis.text.x =  element_text(color="black", size=20, family="economica"),
title =  element_text(color="black", size=20, family="economica"),
text =  element_text(color="black", size=31, family="economica"),
legend.text =  element_text(color="black", size=24, family="economica",vjust = 1.5,margin = margin(t = 10)),
plot.caption = element_text(hjust = 0.55, face= "italic", size=20, family="economica"),
plot.caption.position =  "plot"
) +
labs(
caption = substitute(paste("rho = ",rho_aa_fpkm,", p-value = ",pval_aa_fpkm), list(
rho_aa_fpkm = round(spearman_method_aa$estimate, 2),
pval_aa_fpkm = formatC(spearman_method_aa$p.value, format = "e", digits = 0)))
)
pC
jpeg(paste(path_pannel,"p2C_supp.jpg",sep=""), width = 4000/1, height = 2500/1,res=550/1)
print(pC)
dev.off()
# Supplementary Pannel 2 D
dt_graph = data1_supp[data1_supp$species == "Homo_sapiens",]
spearman_method_aa = cor.test( dt_graph$gene_copies, dt_graph$prop_transcriptome_count,method="spearman",exact=F)
pD=ggplot(dt_graph,aes(x=prop_transcriptome_count*100,y=gene_copies)) + geom_smooth(method='lm',linetype='dashed',se=F, formula= y~x,col=set_color[1],size=2) +
geom_point(pch=21,fill=set_color[2],size=4) +
xlab("Amino-acid frequency (%)") + ylab("Gene copy number") +
theme_bw() + theme(
axis.title.x = element_text(color="black", size=26,family="economica"),
axis.title.y = element_text(color="black", size=26, family="economica"),
axis.text.y =  element_text(color="black", size=20, family="economica"),
axis.text.x =  element_text(color="black", size=20, family="economica"),
title =  element_text(color="black", size=20, family="economica"),
text =  element_text(color="black", size=31, family="economica"),
legend.text =  element_text(color="black", size=24, family="economica",vjust = 1.5,margin = margin(t = 10)),
plot.caption = element_text(hjust = .55, face= "italic", size=20, family="economica"),
plot.caption.position =  "plot"
) +
labs(
caption = substitute(paste("rho = ",rho_aa_fpkm,", p-value = ",pval_aa_fpkm), list(
rho_aa_fpkm = round(spearman_method_aa$estimate, 2),
pval_aa_fpkm = formatC(spearman_method_aa$p.value, format = "e", digits = 0)))
)
pD
jpeg(paste(path_pannel,"p2D_supp.jpg",sep=""), width = 4000/1, height = 2500/1,res=550/1)
print(pD)
dev.off()
# Supplementary Figure 2
imgA = load.image(paste(path_pannel,"p2A_supp.jpg",sep="") )
imgB = load.image(paste(path_pannel,"p2B_supp.jpg",sep="") )
imgC = load.image(paste(path_pannel,"p2C_supp.jpg",sep="") )
imgD = load.image(paste(path_pannel,"p2D_supp.jpg",sep="") )
human<-readPNG(paste(path_require,"human.png",sep=""))
fly<-readPNG(paste(path_require,"Drosophila_melanogaster.png",sep=""))
{
pdf(file= paste(path_figure,"Figure3_supp.pdf",sep=""), width=6.75, height=4)
m=matrix(rep(NA,10*10), nrow=10)
for(i in 1:10){
m[i,]=c(rep(1,5),rep(2,5))
}
for(i in 6:10){
m[i,]=c(rep(3,5),rep(4,5))
}
m
layout(m)
par(mar=c(0, 1, 1.5, 0))
plot(imgA, axes=FALSE)
mtext("A", adj=-.2, side=2,at=-40, line=1, font=2, cex=1.2,las=2)
xaxis=600/1.1
yaxis=500/1.1
rasterImage(fly,xleft=0+xaxis, ybottom=0+yaxis, xright=1100/4+xaxis, ytop=-900/4+yaxis)
par(mar=c(0, 1, 1.5, 0))
plot(imgB, axes=FALSE)
mtext("B", adj=-.2, side=2,at=-40, line=1, font=2, cex=1.2,las=2)
xhuman=510
yhuman=-90
rasterImage(human,xleft=0+xhuman, ybottom=450/1-yhuman, xright=190/1+xhuman, ytop=0-yhuman)
par(mar=c(0, 1, 1.5, 0))
plot(imgC, axes=FALSE)
mtext("C", adj=-.2, side=2,at=-40, line=1, font=2, cex=1.2,las=2)
xaxis=500/1.1
yaxis=500/1.1
rasterImage(fly,xleft=0+xaxis, ybottom=0+yaxis, xright=1100/4+xaxis, ytop=-900/4+yaxis)
par(mar=c(0, 1, 1.5, 0))
plot(imgD, axes=FALSE)
mtext("D", adj=-.2, side=2,at=-40, line=1, font=2, cex=1.2,las=2)
xhuman=450
yhuman=-90
rasterImage(human,xleft=0+xhuman, ybottom=450/1-yhuman, xright=190/1+xhuman, ytop=0-yhuman)
dev.off()
}
{
pdf(file= paste(path_figure,"Figure3_supp.pdf",sep=""), width=6.75, height=4)
m=matrix(rep(NA,10*10), nrow=10)
for(i in 1:10){
m[i,]=c(rep(1,5),rep(2,5))
}
for(i in 6:10){
m[i,]=c(rep(3,5),rep(4,5))
}
m
layout(m)
par(mar=c(0, 1, 1.5, 0))
plot(imgA, axes=FALSE)
mtext("A", adj=-.2, side=2,at=-40, line=1, font=2, cex=1.2,las=2)
xaxis=600/1.1
yaxis=500/1.1
rasterImage(fly,xleft=0+xaxis, ybottom=0+yaxis, xright=1100/4+xaxis, ytop=-900/4+yaxis)
par(mar=c(0, 1, 1.5, 0))
plot(imgB, axes=FALSE)
mtext("B", adj=-.2, side=2,at=-40, line=1, font=2, cex=1.2,las=2)
xhuman=530
yhuman=-90
rasterImage(human,xleft=0+xhuman, ybottom=450/1-yhuman, xright=190/1+xhuman, ytop=0-yhuman)
par(mar=c(0, 1, 1.5, 0))
plot(imgC, axes=FALSE)
mtext("C", adj=-.2, side=2,at=-40, line=1, font=2, cex=1.2,las=2)
xaxis=500/1.1
yaxis=500/1.1
rasterImage(fly,xleft=0+xaxis, ybottom=0+yaxis, xright=1100/4+xaxis, ytop=-900/4+yaxis)
par(mar=c(0, 1, 1.5, 0))
plot(imgD, axes=FALSE)
mtext("D", adj=-.2, side=2,at=-40, line=1, font=2, cex=1.2,las=2)
xhuman=450
yhuman=-90
rasterImage(human,xleft=0+xhuman, ybottom=450/1-yhuman, xright=190/1+xhuman, ytop=0-yhuman)
dev.off()
}
