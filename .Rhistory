tRNA_long$clade_group = GTDrift_list_species[str_replace_all(tRNA_long$sp," ","_"),]$clade_group
tRNA_long$aa_name = code[tRNA_long$tRNA,]$aa_name
tRNA_long$amino_acid = code[tRNA_long$tRNA,]$aa_name
tRNA_long$anticodon = code[tRNA_long$tRNA,]$anticodon
tRNA_long$codon = code[tRNA_long$tRNA,]$codon
tRNA_long$amino_acid = factor(tRNA_long$aa_name,levels = unique(code[order(code$nb_syn,code$anticodon),]$aa_name))
tRNA_long$anticodon = str_replace_all(tRNA_long$anticodon,'T','U')
tRNA_long$codon = str_replace_all(tRNA_long$codon,'T','U')
vect_debut = c("AT","GT","AC","GC","GG","CC","TC","AG","CG","CT","TT","AA","GA","CA","TG","TA")
vect_debut = str_replace_all(vect_debut,"T","U")
tRNA_long$title = paste(tRNA_long$anticodon,sep="")
tRNA_long$codon = factor(tRNA_long$codon,levels =  unlist(lapply(vect_debut,function(x) paste(x,c("C","U","A","G"),sep=""))) )
tRNA_long$title = factor(tRNA_long$title,levels= tapply(tRNA_long$title, as.integer(tRNA_long$codon),unique))
tRNA_long$color = sapply(tRNA_long$codon,function(x)substr(x,3,3))
tRNA_long$color = paste("NN",tRNA_long$color,sep="")
set_color = c(NNA="#B2DF8A",NNU="#33A02C",NNC="#1F78B4",NNG="#A6CEE3")
b <- ggplot(tRNA_long[!tRNA_long$aa_name %in% c("Ter"),], aes(x=title, y=sp,color=color)) +
geom_point(aes(size=count), stroke = 0) + # stroke=0 so that we don't see the 0, but they are still here
#scale_size(range=c(0, 10)) +
scale_size_area("Gene copy number") +                       # better eye rendering than radius
theme_bw() +
theme(
axis.text.x = element_text(size=5, angle=90),
axis.text.y=element_text(size=3),
panel.grid.major = element_line(color = "grey",
size = 0.1,
linetype = 2),
panel.grid.major.x = element_blank() ,
panel.spacing = unit(0, "lines"),
panel.border = element_rect(color = "grey", fill = NA)) + theme(
title =  element_text(size=20, family="ubuntu condensed"),
legend.text =  element_text(size=20, family="ubuntu condensed"),
strip.text = element_text(size=15, family="ubuntu condensed",face="bold"),
axis.text.x =  element_text( size=5,vjust = 0.5, family="ubuntu condensed"),
axis.title.x =  element_text( size=7),
axis.text.y =  element_text( size=3, family="ubuntu condensed",face="italic"),
plot.title = element_text(hjust = 0.5,margin = margin(0,0,20,0))
) +
xlab("Anticodons") + ylab(NULL)+scale_color_manual("Decoded codons",values = set_color) + facet_wrap(~amino_acid,ncol=length(unique(tRNA_long$amino_acid)),scales="free_x")+
guides(colour = guide_legend(override.aes = list(size=5)))
b
h <- tRNA_long %>% group_by(sp) %>%
summarize(tRNAlociCount = sum(count),clade_group=unique(clade_group)) %>%
ggplot(aes(y=sp, x=tRNAlociCount,fill=clade_group)) +
geom_col(col="black",size=0.1) +
scale_fill_manual("Clades",values=Clade_color[unique(edge_clade)]) +
theme_bw() +
theme(
axis.text.x = element_text(size=7),
panel.grid.major = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank()) + theme(
title =  element_text(size=20, family="ubuntu condensed"),
legend.text =  element_text(size=15, family="ubuntu condensed"),
strip.text = element_text(size=15, family="ubuntu condensed",face="bold"),
axis.text.x =  element_text( size=10, family="ubuntu condensed"),
axis.text.y =  element_text( size=0, family="ubuntu condensed"),
plot.title = element_text(hjust = 0.5,margin = margin(0,0,20,0))
)+
xlab(NULL) + ylab(NULL)
h
#make hist
pB = b %>% insert_left(pA, width=0.7) %>% insert_right(h, width=0.4 )
pB
jpeg(paste(path_pannel,"p2A_supp.jpg",sep=""), width = 2000/.2,  1200/.2,res=100/.2)
print(pB)
dev.off()
# Supplementary Figure 2
imgA = load.image(paste(path_pannel,"p2A_supp.jpg",sep="") )
{
pdf(file= paste(path_figure,"Figure2_supp.pdf",sep=""), width=6.75, height=4)
m=matrix(rep(1,10*10), nrow=10)
layout(m)
par(mar=c(0, 1, 0, 0))
plot(imgA, axes=FALSE)
dev.off()
}
pA = ggtree(arbrePhylotips) %>% flip(264, 375)
pA <- pA %<+% node_metadata  + aes(color=color) +
scale_color_manual("Clade",values=Clade_color[unique(edge_clade)]) + theme(
panel.background = element_rect(fill = "white", linetype = "dashed")
)  + theme(legend.position = "none") + geom_tiplab(align=TRUE, linetype='dashed', linesize=.3,size=0)
pA
# tidy the data
tRNA_long <-
tRNA %>% rownames_to_column(var='sp') %>%
pivot_longer(cols=!sp,
names_to = 'tRNA',
values_to = "count")
# Generate Supplementary Figure 3
source("figure/figure_supp_generator/library_path.R")
# Pannel A
dataX = read.delim("data/data_16.tab")
dt_graph = dataX
spearman_method_aa = cor.test( dt_graph$nb_copy_Caenorhabditis_elegans, dt_graph$nb_copy_Hydra_vulgaris,method="spearman",exact=F)
pA = ggplot(dt_graph,aes(x=nb_copy_Hydra_vulgaris ,y=nb_copy_Caenorhabditis_elegans,label=aa_name_Caenorhabditis_elegans)) +
# geom_smooth(formula = y ~ x, method="lm", size=1 , col=set_color[1],se=F,linetype='dashed') +
geom_point(pch=21,size=4,fill=set_color[2]) +
geom_text(nudge_x = 1.7,size=5,family="ubuntu condensed") + theme_bw() +  theme(
axis.title.x = element_text(color="black", size=22,family="ubuntu condensed"),
axis.title.y = element_text(color="black", size=22,hjust=1, family="ubuntu condensed"),
axis.text.y =  element_text(color="black", size=22, family="ubuntu condensed"),
axis.text.x =  element_text(color="black", size=22, family="ubuntu condensed"),
title =  element_text(color="black", size=18, family="ubuntu condensed"),
legend.text =  element_text(color="black", size=16, family="ubuntu condensed"),
strip.text = element_text(size=15),
plot.caption = element_text(hjust = 0.55, face= "italic", size=20, family="ubuntu condensed"),
plot.caption.position =  "plot"
) +
xlab(expression(paste("tRNA gene copy number (",italic("Hydra vulgaris"),")"))) +
ylab(expression(paste("tRNA gene copy number (",italic("Caenorhabditis elegans"),")"))) +
labs(
caption = substitute(paste("rho = ",rho_aa_fpkm,", p-value = ",pval_aa_fpkm), list(
rho_aa_fpkm = round(spearman_method_aa$estimate, 2),
pval_aa_fpkm = formatC(spearman_method_aa$p.value, format = "e", digits = 0)))
)
pA
jpeg(paste(path_pannel,"p3A_supp.jpg",sep=""), width = 4000/1, height = 4000/1,res=700/1)
print(pA)
dev.off()
# Pannel B
data15 = read.delim("data/data_15.tab")
data15$clade_group = GTDrift_list_species[data15$species2,]$clade_group
data1 = read.delim("data/data1_supp.tab")
rownames(data1) = data1$species
data1 = data1[ data1$nb_genes_filtered >= 5000 ,]
data15$pval_aa_fpkm = data1[data15$species2,]$pval_aa_fpkm<0.05
# data15$pval_aa_fpkm = data1[data15$species2,]$nb_codon_not_decoded != 0
dt_graph = data15[data15$species2 %in% data1$species,]
pB = ggplot(dt_graph,aes(y=rho,fill=clade_group,x=clade_group))  +
geom_hline(size=1,linetype="dashed",col="red", yintercept = min(dt_graph[dt_graph$rho & dt_graph$pval < 0.05,]$rho) ) +
geom_text (label="p-value < 0.05", y=.4,x="Lepido Diptera",size=5,family="ubuntu condensed",col="red") + geom_boxplot(alpha=.1) +
geom_point(aes(fill=clade_group,pch=pval_aa_fpkm),size=3,alpha=0.7) + theme_bw() + theme(
axis.title.x = element_text(color="black",angle = 50, size=25,family="ubuntu condensed"),
axis.title.y = element_text(color="black", size=22, family="ubuntu condensed"),
axis.text.y =  element_text(color="black", size=20, family="ubuntu condensed"),
axis.text.x =  element_text(color="black",vjust=1,hjust=1, size=22,angle = 30, family="ubuntu condensed"),
title =  element_text(color="black", size=0, family="ubuntu condensed"),
legend.text =  element_text(color="black", size=20, family="ubuntu condensed")
) + theme(legend.position='none') + scale_fill_manual(values=Clade_color) + scale_shape_manual(values=c(24,21)) + ylab("Spearmann rho")  + xlab("") + ylim(0,1)
pB = ggMarginal(pB, type="histogram",fill=set_color[1])
pB
jpeg(paste(path_pannel,"p3B_supp.jpg",sep=""), width = 4000/1, height = 2500/1,res=400/1)
print(pB)
dev.off()
# Supplementary Figure 3
imgA = load.image(paste(path_pannel,"p3A_supp.jpg",sep="") )
imgB = load.image(paste(path_pannel,"p3B_supp.jpg",sep="") )
{
pdf(file= paste(path_figure,"Figure13_supp.pdf",sep=""), width=11, height=4)
m=matrix(rep(NA,10*100), nrow=10)
for(i in 1:10){
m[i,]=c(rep(1,35),rep(2,65))
}
m
layout(m)
par(mar=c(0, 2, 2, 1))
plot(imgA, axes=FALSE)
mtext("A", adj=0, side=2,at=-200, line=1, font=2, cex=2.2,las=2)
par(mar=c(0, 0, 0, 0))
plot(imgB, axes=FALSE)
mtext("B",adj=-1, side=2,at=150, line=1, font=2, cex=2.2,las=2)
dev.off()
}
# Generate Supplementary Figure 3
source("figure/figure_supp_generator/library_path.R")
# Pannel A
dataX = read.delim("data/data_16.tab")
dt_graph = dataX
spearman_method_aa = cor.test( dt_graph$nb_copy_Caenorhabditis_elegans, dt_graph$nb_copy_Hydra_vulgaris,method="spearman",exact=F)
pA = ggplot(dt_graph,aes(x=nb_copy_Hydra_vulgaris ,y=nb_copy_Caenorhabditis_elegans,label=aa_name_Caenorhabditis_elegans)) +
# geom_smooth(formula = y ~ x, method="lm", size=1 , col=set_color[1],se=F,linetype='dashed') +
geom_point(pch=21,size=4,fill=set_color[2]) +
geom_text(nudge_x = 1.7,size=5,family="ubuntu condensed") + theme_bw() +  theme(
axis.title.x = element_text(color="black", size=22,family="ubuntu condensed"),
axis.title.y = element_text(color="black", size=22,hjust=1, family="ubuntu condensed"),
axis.text.y =  element_text(color="black", size=22, family="ubuntu condensed"),
axis.text.x =  element_text(color="black", size=22, family="ubuntu condensed"),
title =  element_text(color="black", size=18, family="ubuntu condensed"),
legend.text =  element_text(color="black", size=16, family="ubuntu condensed"),
strip.text = element_text(size=15),
plot.caption = element_text(hjust = 0.55, face= "italic", size=20, family="ubuntu condensed"),
plot.caption.position =  "plot"
) +
xlab(expression(paste("tRNA gene copy number (",italic("Hydra vulgaris"),")"))) +
ylab(expression(paste("tRNA gene copy number (",italic("Caenorhabditis elegans"),")"))) +
labs(
caption = substitute(paste("rho = ",rho_aa_fpkm,", p-value = ",pval_aa_fpkm), list(
rho_aa_fpkm = round(spearman_method_aa$estimate, 2),
pval_aa_fpkm = formatC(spearman_method_aa$p.value, format = "e", digits = 0)))
)
pA
jpeg(paste(path_pannel,"p3A_supp.jpg",sep=""), width = 4000/1, height = 4000/1,res=700/1)
print(pA)
dev.off()
# Pannel B
data15 = read.delim("data/data_15.tab")
data15$clade_group = GTDrift_list_species[data15$species2,]$clade_group
data1 = read.delim("data/data1_supp.tab")
rownames(data1) = data1$species
data1 = data1[ data1$nb_genes_filtered >= 5000 ,]
data15$pval_aa_fpkm = data1[data15$species2,]$pval_aa_fpkm<0.05
# data15$pval_aa_fpkm = data1[data15$species2,]$nb_codon_not_decoded != 0
dt_graph = data15[data15$species2 %in% data1$species,]
pB = ggplot(dt_graph,aes(y=rho,fill=clade_group,x=clade_group))  +
geom_hline(size=1,linetype="dashed",col="red", yintercept = min(dt_graph[dt_graph$rho & dt_graph$pval < 0.05,]$rho) ) +
geom_text (label="p-value < 0.05", y=.4,x="Lepido Diptera",size=5,family="ubuntu condensed",col="red") + geom_boxplot(alpha=.1) +
geom_point(aes(fill=clade_group,pch=pval_aa_fpkm),size=3,alpha=0.7) + theme_bw() + theme(
axis.title.x = element_text(color="black",angle = 50, size=25,family="ubuntu condensed"),
axis.title.y = element_text(color="black", size=22, family="ubuntu condensed"),
axis.text.y =  element_text(color="black", size=20, family="ubuntu condensed"),
axis.text.x =  element_text(color="black",vjust=1,hjust=1, size=22,angle = 30, family="ubuntu condensed"),
title =  element_text(color="black", size=0, family="ubuntu condensed"),
legend.text =  element_text(color="black", size=20, family="ubuntu condensed")
) + theme(legend.position='none') + scale_fill_manual(values=Clade_color) + scale_shape_manual(values=c(24,21)) + ylab("Spearmann rho")  + xlab("") + ylim(0,1)
pB = ggMarginal(pB, type="histogram",fill=set_color[1])
pB
jpeg(paste(path_pannel,"p3B_supp.jpg",sep=""), width = 4000/1, height = 2500/1,res=400/1)
print(pB)
dev.off()
# Supplementary Figure 3
imgA = load.image(paste(path_pannel,"p3A_supp.jpg",sep="") )
imgB = load.image(paste(path_pannel,"p3B_supp.jpg",sep="") )
{
pdf(file= paste(path_figure,"Figure3_supp.pdf",sep=""), width=11, height=4)
m=matrix(rep(NA,10*100), nrow=10)
for(i in 1:10){
m[i,]=c(rep(1,35),rep(2,65))
}
m
layout(m)
par(mar=c(0, 2, 2, 1))
plot(imgA, axes=FALSE)
mtext("A", adj=0, side=2,at=-200, line=1, font=2, cex=2.2,las=2)
par(mar=c(0, 0, 0, 0))
plot(imgB, axes=FALSE)
mtext("B",adj=-1, side=2,at=150, line=1, font=2, cex=2.2,las=2)
dev.off()
}
# Generate Supplementary Figure 3
source("figure/figure_supp_generator/library_path.R")
# Pannel A
dataX = read.delim("data/data_16.tab")
dt_graph = dataX
spearman_method_aa = cor.test( dt_graph$nb_copy_Caenorhabditis_elegans, dt_graph$nb_copy_Hydra_vulgaris,method="spearman",exact=F)
pA = ggplot(dt_graph,aes(x=nb_copy_Hydra_vulgaris ,y=nb_copy_Caenorhabditis_elegans,label=aa_name_Caenorhabditis_elegans)) +
# geom_smooth(formula = y ~ x, method="lm", size=1 , col=set_color[1],se=F,linetype='dashed') +
geom_point(pch=21,size=4,fill=set_color[2]) +
geom_text(nudge_x = 1.7,size=5,family="ubuntu condensed") + theme_bw() +  theme(
axis.title.x = element_text(color="black", size=22,family="ubuntu condensed"),
axis.title.y = element_text(color="black", size=22,hjust=1, family="ubuntu condensed"),
axis.text.y =  element_text(color="black", size=22, family="ubuntu condensed"),
axis.text.x =  element_text(color="black", size=22, family="ubuntu condensed"),
title =  element_text(color="black", size=18, family="ubuntu condensed"),
legend.text =  element_text(color="black", size=16, family="ubuntu condensed"),
strip.text = element_text(size=15),
plot.caption = element_text(hjust = 0.55, face= "italic", size=20, family="ubuntu condensed"),
plot.caption.position =  "plot"
) +
xlab(expression(paste("tRNA gene copy number (",italic("Hydra vulgaris"),")"))) +
ylab(expression(paste("tRNA gene copy number (",italic("Caenorhabditis elegans"),")"))) +
labs(
caption = substitute(paste("rho = ",rho_aa_fpkm,", p-value = ",pval_aa_fpkm), list(
rho_aa_fpkm = round(spearman_method_aa$estimate, 2),
pval_aa_fpkm = formatC(spearman_method_aa$p.value, format = "e", digits = 0)))
)
pA
jpeg(paste(path_pannel,"p3A_supp.jpg",sep=""), width = 4000/1, height = 4000/1,res=700/1)
print(pA)
dev.off()
# Pannel B
data15 = read.delim("data/data_15.tab")
data15$clade_group = GTDrift_list_species[data15$species2,]$clade_group
data1 = read.delim("data/data1_supp.tab")
rownames(data1) = data1$species
data1 = data1[ data1$nb_genes_filtered >= 5000 ,]
data15$pval_aa_fpkm = data1[data15$species2,]$pval_aa_fpkm < 0.05
dt_graph = data15[data15$species2 %in% data1$species,]
pB = ggplot(dt_graph,aes(y=rho,fill=clade_group,x=clade_group))  +
geom_hline(size=1,linetype="dashed",col="red", yintercept = min(dt_graph[dt_graph$rho & dt_graph$pval < 0.05,]$rho) ) +
geom_text (label="p-value < 0.05", y=.4,x="Lepido Diptera",size=5,family="ubuntu condensed",col="red") + geom_boxplot(alpha=.1) +
geom_point(aes(fill=clade_group,pch=pval_aa_fpkm),size=3,alpha=0.7) + theme_bw() + theme(
axis.title.x = element_text(color="black",angle = 50, size=25,family="ubuntu condensed"),
axis.title.y = element_text(color="black",vjust=2, size=22, family="ubuntu condensed"),
axis.text.y =  element_text(color="black", size=20, family="ubuntu condensed"),
axis.text.x =  element_text(color="black",vjust=1,hjust=1, size=22,angle = 30, family="ubuntu condensed"),
title =  element_text(color="black", size=0, family="ubuntu condensed"),
legend.text =  element_text(color="black", size=20, family="ubuntu condensed")
) + theme(legend.position='none') + scale_fill_manual(values=Clade_color) + scale_shape_manual(values=c(24,21)) + ylab("Spearmann rho")  + xlab("") + ylim(0,1)
pB = ggMarginal(pB, type="histogram",fill=set_color[1])
pB
# Generate Supplementary Figure 3
source("figure/figure_supp_generator/library_path.R")
# Pannel A
dataX = read.delim("data/data_16.tab")
dt_graph = dataX
spearman_method_aa = cor.test( dt_graph$nb_copy_Caenorhabditis_elegans, dt_graph$nb_copy_Hydra_vulgaris,method="spearman",exact=F)
pA = ggplot(dt_graph,aes(x=nb_copy_Hydra_vulgaris ,y=nb_copy_Caenorhabditis_elegans,label=aa_name_Caenorhabditis_elegans)) +
# geom_smooth(formula = y ~ x, method="lm", size=1 , col=set_color[1],se=F,linetype='dashed') +
geom_point(pch=21,size=4,fill=set_color[2]) +
geom_text(nudge_x = 1.7,size=5,family="ubuntu condensed") + theme_bw() +  theme(
axis.title.x = element_text(color="black", size=22,family="ubuntu condensed"),
axis.title.y = element_text(color="black", size=22,hjust=1, family="ubuntu condensed"),
axis.text.y =  element_text(color="black", size=22, family="ubuntu condensed"),
axis.text.x =  element_text(color="black", size=22, family="ubuntu condensed"),
title =  element_text(color="black", size=18, family="ubuntu condensed"),
legend.text =  element_text(color="black", size=16, family="ubuntu condensed"),
strip.text = element_text(size=15),
plot.caption = element_text(hjust = 0.55, face= "italic", size=20, family="ubuntu condensed"),
plot.caption.position =  "plot"
) +
xlab(expression(paste("tRNA gene copy number (",italic("Hydra vulgaris"),")"))) +
ylab(expression(paste("tRNA gene copy number (",italic("Caenorhabditis elegans"),")"))) +
labs(
caption = substitute(paste("rho = ",rho_aa_fpkm,", p-value = ",pval_aa_fpkm), list(
rho_aa_fpkm = round(spearman_method_aa$estimate, 2),
pval_aa_fpkm = formatC(spearman_method_aa$p.value, format = "e", digits = 0)))
)
pA
jpeg(paste(path_pannel,"p3A_supp.jpg",sep=""), width = 4000/1, height = 4000/1,res=700/1)
print(pA)
dev.off()
# Pannel B
data15 = read.delim("data/data_15.tab")
data15$clade_group = GTDrift_list_species[data15$species2,]$clade_group
data1 = read.delim("data/data1_supp.tab")
rownames(data1) = data1$species
data1 = data1[ data1$nb_genes_filtered >= 5000 ,]
data15$pval_aa_fpkm = data1[data15$species2,]$pval_aa_fpkm < 0.05
dt_graph = data15[data15$species2 %in% data1$species,]
pB = ggplot(dt_graph,aes(y=rho,fill=clade_group,x=clade_group))  +
geom_hline(size=1,linetype="dashed",col="red", yintercept = min(dt_graph[dt_graph$rho & dt_graph$pval < 0.05,]$rho) ) +
geom_text (label="p-value < 0.05", y=.4,x="Lepido Diptera",size=5,family="ubuntu condensed",col="red") + geom_boxplot(alpha=.1) +
geom_point(aes(fill=clade_group,pch=pval_aa_fpkm),size=3,alpha=0.7) + theme_bw() + theme(
axis.title.x = element_text(color="black",angle = 50, size=25,family="ubuntu condensed"),
axis.title.y = element_text(color="black",vjust=2, size=22, family="ubuntu condensed"),
axis.text.y =  element_text(color="black", size=20, family="ubuntu condensed"),
axis.text.x =  element_text(color="black",vjust=1,hjust=1, size=22,angle = 30, family="ubuntu condensed"),
title =  element_text(color="black", size=0, family="ubuntu condensed"),
legend.text =  element_text(color="black", size=20, family="ubuntu condensed")
) + theme(legend.position='none') + scale_fill_manual(values=Clade_color) + scale_shape_manual(values=c(24,21)) + ylab("Spearmann rho")  + xlab("") + ylim(0,1)
pB = ggMarginal(pB, type="histogram",fill=set_color[1])
pB
jpeg(paste(path_pannel,"p3B_supp.jpg",sep=""), width = 4000/1, height = 2500/1,res=400/1)
print(pB)
dev.off()
pB = ggplot(dt_graph,aes(y=rho,fill=clade_group,x=clade_group))  +
geom_hline(size=1,linetype="dashed",col="red", yintercept = min(dt_graph[dt_graph$rho & dt_graph$pval < 0.05,]$rho) ) +
geom_text (label="p-value < 0.05", y=.4,x="Lepido Diptera",size=5,family="ubuntu condensed",col="red") + geom_boxplot(alpha=.1) +
geom_point(aes(fill=clade_group,pch=pval_aa_fpkm),size=3,alpha=0.7) + theme_bw() + theme(
axis.title.x = element_text(color="black",angle = 50, size=25,family="ubuntu condensed"),
axis.title.y = element_text(color="black",vjust=0, size=22, family="ubuntu condensed"),
axis.text.y =  element_text(color="black", size=20, family="ubuntu condensed"),
axis.text.x =  element_text(color="black",vjust=1,hjust=1, size=22,angle = 30, family="ubuntu condensed"),
title =  element_text(color="black", size=0, family="ubuntu condensed"),
legend.text =  element_text(color="black", size=20, family="ubuntu condensed")
) + theme(legend.position='none') + scale_fill_manual(values=Clade_color) + scale_shape_manual(values=c(24,21)) + ylab("Spearmann rho")  + xlab("") + ylim(0,1)
pB = ggMarginal(pB, type="histogram",fill=set_color[1])
pB
jpeg(paste(path_pannel,"p3B_supp.jpg",sep=""), width = 4000/1, height = 2500/1,res=400/1)
print(pB)
dev.off()
# Generate Supplementary Figure 3
source("figure/figure_supp_generator/library_path.R")
# Pannel A
dataX = read.delim("data/data_16.tab")
dt_graph = dataX
spearman_method_aa = cor.test( dt_graph$nb_copy_Caenorhabditis_elegans, dt_graph$nb_copy_Hydra_vulgaris,method="spearman",exact=F)
pA = ggplot(dt_graph,aes(x=nb_copy_Hydra_vulgaris ,y=nb_copy_Caenorhabditis_elegans,label=aa_name_Caenorhabditis_elegans)) +
# geom_smooth(formula = y ~ x, method="lm", size=1 , col=set_color[1],se=F,linetype='dashed') +
geom_point(pch=21,size=4,fill=set_color[2]) +
geom_text(nudge_x = 1.7,size=5,family="ubuntu condensed") + theme_bw() +  theme(
axis.title.x = element_text(color="black", size=22,family="ubuntu condensed"),
axis.title.y = element_text(color="black", size=22,hjust=1, family="ubuntu condensed"),
axis.text.y =  element_text(color="black", size=22, family="ubuntu condensed"),
axis.text.x =  element_text(color="black", size=22, family="ubuntu condensed"),
title =  element_text(color="black", size=18, family="ubuntu condensed"),
legend.text =  element_text(color="black", size=16, family="ubuntu condensed"),
strip.text = element_text(size=15),
plot.caption = element_text(hjust = 0.55, face= "italic", size=20, family="ubuntu condensed"),
plot.caption.position =  "plot"
) +
xlab(expression(paste("tRNA gene copy number (",italic("Hydra vulgaris"),")"))) +
ylab(expression(paste("tRNA gene copy number (",italic("Caenorhabditis elegans"),")"))) +
labs(
caption = substitute(paste("rho = ",rho_aa_fpkm,", p-value = ",pval_aa_fpkm), list(
rho_aa_fpkm = round(spearman_method_aa$estimate, 2),
pval_aa_fpkm = formatC(spearman_method_aa$p.value, format = "e", digits = 0)))
)
pA
jpeg(paste(path_pannel,"p3A_supp.jpg",sep=""), width = 4000/1, height = 4000/1,res=700/1)
print(pA)
dev.off()
# Pannel B
data15 = read.delim("data/data_15.tab")
data15$clade_group = GTDrift_list_species[data15$species2,]$clade_group
data1 = read.delim("data/data1_supp.tab")
rownames(data1) = data1$species
data1 = data1[ data1$nb_genes_filtered >= 5000 ,]
data15$pval_aa_fpkm = data1[data15$species2,]$pval_aa_fpkm < 0.05
dt_graph = data15[data15$species2 %in% data1$species,]
pB = ggplot(dt_graph,aes(y=rho,fill=clade_group,x=clade_group))  +
geom_hline(size=1,linetype="dashed",col="red", yintercept = min(dt_graph[dt_graph$rho & dt_graph$pval < 0.05,]$rho) ) +
geom_text (label="p-value < 0.05", y=.4,x="Lepido Diptera",size=5,family="ubuntu condensed",col="red") + geom_boxplot(alpha=.1) +
geom_point(aes(fill=clade_group,pch=pval_aa_fpkm),size=3,alpha=0.7) + theme_bw() + theme(
axis.title.x = element_text(color="black",angle = 50, size=25,family="ubuntu condensed"),
axis.title.y = element_text(color="black",vjust=2, size=22, family="ubuntu condensed"),
axis.text.y =  element_text(color="black", size=20, family="ubuntu condensed"),
axis.text.x =  element_text(color="black",vjust=1,hjust=1, size=22,angle = 30, family="ubuntu condensed"),
title =  element_text(color="black", size=0, family="ubuntu condensed"),
legend.text =  element_text(color="black", size=20, family="ubuntu condensed")
) + theme(legend.position='none') + scale_fill_manual(values=Clade_color) + scale_shape_manual(values=c(24,21)) + ylab("Spearmann rho")  + xlab("") + ylim(0,1)
pB = ggMarginal(pB, type="histogram",fill=set_color[1])
pB
jpeg(paste(path_pannel,"p3B_supp.jpg",sep=""), width = 4000/1, height = 2500/1,res=400/1)
print(pB)
dev.off()
# Supplementary Figure 3
imgA = load.image(paste(path_pannel,"p3A_supp.jpg",sep="") )
imgB = load.image(paste(path_pannel,"p3B_supp.jpg",sep="") )
{
pdf(file= paste(path_figure,"Figure3_supp.pdf",sep=""), width=11, height=4)
m=matrix(rep(NA,10*100), nrow=10)
for(i in 1:10){
m[i,]=c(rep(1,35),rep(2,65))
}
m
layout(m)
par(mar=c(0, 2, 2, 1))
plot(imgA, axes=FALSE)
mtext("A", adj=0, side=2,at=-200, line=1, font=2, cex=2.2,las=2)
par(mar=c(0, 0, 0, 0))
plot(imgB, axes=FALSE)
mtext("B",adj=-1, side=2,at=150, line=1, font=2, cex=2.2,las=2)
dev.off()
}
da = read.delim("/home/fbenitiere/2024-translational_selection/data/GTDrift_list_species.tab")
sum(da$nb_rnaseq)
# Generate Supplementary Figure 3
source("figure/figure_supp_generator/library_path.R")
# Pannel A
dataX = read.delim("data/data_16.tab")
dt_graph = dataX
spearman_method_aa = cor.test( dt_graph$nb_copy_Caenorhabditis_elegans, dt_graph$nb_copy_Hydra_vulgaris,method="spearman",exact=F)
pA = ggplot(dt_graph,aes(x=nb_copy_Hydra_vulgaris ,y=nb_copy_Caenorhabditis_elegans,label=aa_name_Caenorhabditis_elegans)) +
# geom_smooth(formula = y ~ x, method="lm", size=1 , col=set_color[1],se=F,linetype='dashed') +
geom_point(pch=21,size=4,fill=set_color[2]) +
geom_text(nudge_x = 1.7,size=5,family="ubuntu condensed") + theme_bw() +  theme(
axis.title.x = element_text(color="black", size=22,family="ubuntu condensed"),
axis.title.y = element_text(color="black", size=22,hjust=1, family="ubuntu condensed"),
axis.text.y =  element_text(color="black", size=22, family="ubuntu condensed"),
axis.text.x =  element_text(color="black", size=22, family="ubuntu condensed"),
title =  element_text(color="black", size=18, family="ubuntu condensed"),
legend.text =  element_text(color="black", size=16, family="ubuntu condensed"),
strip.text = element_text(size=15),
plot.caption = element_text(hjust = 0.55, face= "italic", size=20, family="ubuntu condensed"),
plot.caption.position =  "plot"
) +
xlab(expression(paste("tRNA gene copy number (",italic("Hydra vulgaris"),")"))) +
ylab(expression(paste("tRNA gene copy number (",italic("Caenorhabditis elegans"),")"))) +
labs(
caption = substitute(paste("rho = ",rho_aa_fpkm,", p-value = ",pval_aa_fpkm), list(
rho_aa_fpkm = round(spearman_method_aa$estimate, 2),
pval_aa_fpkm = formatC(spearman_method_aa$p.value, format = "e", digits = 0)))
)
pA
jpeg(paste(path_pannel,"p3A_supp.jpg",sep=""), width = 4000/1, height = 4000/1,res=700/1)
print(pA)
dev.off()
# Pannel B
data15 = read.delim("data/data_15.tab")
data15$clade_group = GTDrift_list_species[data15$species2,]$clade_group
data1 = read.delim("data/data1_supp.tab")
rownames(data1) = data1$species
data1 = data1[ data1$nb_genes_filtered >= 5000 ,]
data15$pval_aa_fpkm = data1[data15$species2,]$pval_aa_fpkm < 0.05
dt_graph = data15[data15$species2 %in% data1$species,]
pB = ggplot(dt_graph,aes(y=rho,fill=clade_group,x=clade_group))  +
geom_hline(size=1,linetype="dashed",col="red", yintercept = min(dt_graph[dt_graph$rho & dt_graph$pval < 0.05,]$rho) ) +
geom_text (label="p-value < 0.05", y=.4,x="Lepido Diptera",size=5,family="ubuntu condensed",col="red") + geom_boxplot(alpha=.1) +
geom_point(aes(fill=clade_group,pch=pval_aa_fpkm),size=3,alpha=0.7) + theme_bw() + theme(
axis.title.x = element_text(color="black",angle = 50, size=25,family="ubuntu condensed"),
axis.title.y = element_text(color="black",vjust=2, size=22, family="ubuntu condensed"),
axis.text.y =  element_text(color="black", size=20, family="ubuntu condensed"),
axis.text.x =  element_text(color="black",vjust=1,hjust=1, size=18,angle = 30, family="ubuntu condensed"),
title =  element_text(color="black", size=0, family="ubuntu condensed"),
legend.text =  element_text(color="black", size=20, family="ubuntu condensed")
) + theme(legend.position='none') + scale_fill_manual(values=Clade_color) + scale_shape_manual(values=c(24,21)) + ylab("Spearmann rho")  + xlab("") + ylim(0,1)
pB = ggMarginal(pB, type="histogram",fill=set_color[1])
pB
jpeg(paste(path_pannel,"p3B_supp.jpg",sep=""), width = 4000/1, height = 2500/1,res=400/1)
print(pB)
dev.off()
# Supplementary Figure 3
imgA = load.image(paste(path_pannel,"p3A_supp.jpg",sep="") )
imgB = load.image(paste(path_pannel,"p3B_supp.jpg",sep="") )
{
pdf(file= paste(path_figure,"Figure3_supp.pdf",sep=""), width=11, height=4)
m=matrix(rep(NA,10*100), nrow=10)
for(i in 1:10){
m[i,]=c(rep(1,35),rep(2,65))
}
m
layout(m)
par(mar=c(0, 2, 2, 1))
plot(imgA, axes=FALSE)
mtext("A", adj=0, side=2,at=-200, line=1, font=2, cex=2.2,las=2)
par(mar=c(0, 0, 0, 0))
plot(imgB, axes=FALSE)
mtext("B",adj=-1, side=2,at=150, line=1, font=2, cex=2.2,las=2)
dev.off()
}
