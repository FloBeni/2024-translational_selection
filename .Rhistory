<<<<<<< HEAD
pB = pB +
geom_line(aes(y=density_optimal_to_nonoptimal_codon,color="POC -> non-POC",linetype='CDS',alpha='CDS'),size=1) +
# geom_line(aes(y=sum_subst_density_optimal_to_nonoptimal_codon/sum_cible_density_optimal_to_nonoptimal_codon,color="POC -> non-POC",linetype='CDS',alpha='CDS'),size=1) +
geom_point(aes(y=density_optimal_to_nonoptimal_codon,fill="POC -> non-POC",pch='CDS',alpha='CDS'),size=3)+
geom_errorbar(aes(ymin=confint_low_density_optimal_to_nonoptimal_codon,
ymax=confint_high_density_optimal_to_nonoptimal_codon,color="POC -> non-POC"),
width=0.03,show.legend=FALSE) +
geom_line(aes(y=density_nonoptimal_to_optimal_codon,color="non-POC -> POC",linetype='CDS',alpha='CDS'),size=1) +
# geom_line(aes(y=sum_subst_density_nonoptimal_to_optimal_codon/sum_cible_density_nonoptimal_to_optimal_codon,color="non-POC -> POC",linetype='CDS',alpha='CDS'),size=1) +
geom_point(aes(y=density_nonoptimal_to_optimal_codon,fill="non-POC -> POC",pch='CDS',alpha='CDS'),size=3)+
geom_errorbar(aes(ymin=confint_low_density_nonoptimal_to_optimal_codon,
ymax=confint_high_density_nonoptimal_to_optimal_codon,color="non-POC -> POC"),
width=0.03,show.legend=FALSE)
pB = pB + theme_bw() + theme(
axis.title.x = element_text(color="black", size=0,family="economica"),
axis.title.y = element_text(color="black", size=30, family="economica"),
axis.text.y =  element_text(color="black", size=30, family="economica"),
axis.text.x =  element_text(color="black", size=0, family="economica"),
title =  element_text(color="black", size=0, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica")
) + xlab("Gene expression level (FPKM, log scale)") +
scale_x_log10(limits = c(0.01,1000),
breaks=c(0.005,0.01,0.1,0.5,1,5,10,50,100,1000,10000,50000),
labels=c(0.005,0.01,0.1,0.5,1,5,10,50,100,1000,10000,50000)) +
ylab(paste("SNPs density within CDSs")) + scale_fill_manual("",values=set_color_class,label=labels_name) +
scale_color_manual("",values=set_color_class) + scale_linetype_manual("",values=set_linetype_class) +
scale_shape_manual("",values=set_shape_class) + scale_alpha_manual("",values=set_alpha_class) +
guides(fill= guide_legend(override.aes = list(size=7,pch=21,byrow = TRUE),order = 2)
)  + annotation_logticks(sides="b")+
guides(color = FALSE, size = FALSE , linetype=F, pch=F, alpha=F) + theme(legend.position='none') + ylim(0.01,0.055)+
theme(legend.position = c(0.76, 0.9),
legend.background = element_rect(fill="NA"),
legend.spacing.x = unit(0.5, 'cm'),
legend.spacing.y = unit(0.5, 'cm')
)
pB
# Generate Supplementary Figure 6, 7, 8 & 9
source("figure/figure_main_generator/library_path.R")
set_color_class = c("#E31A1C","#33A02C")
names(set_color_class) = c( "POC -> non-POC","non-POC -> POC")
set_shape_class = c(CDS=21,intron=24)
set_linetype_class = c(CDS="solid",intron="dashed")
set_alpha_class = c(CDS=1,intron=0.5)
###
data_11 = read.delim("data/data11_supp.tab")
dt_graph = data_11[ data_11$group == "POCs" ,]
# Pannel B
labels_name = c( "POC -> non-POC" = paste( format(sum(dt_graph$sum_subst_density_optimal_to_nonoptimal_codon),big.mark=",",scientific=T)," SNPs POC -> non-POC",sep=""),
"non-POC -> POC"=paste( format(sum(dt_graph$sum_subst_density_nonoptimal_to_optimal_codon),big.mark=",",scientific=T)," SNPs non-POC -> POC",sep=""))
pB = ggplot(dt_graph,aes(x=fpkm)) + ggtitle("POCs")
pB = pB +
geom_line(aes(y=density_optimal_to_nonoptimal_codon,color="POC -> non-POC",linetype='CDS',alpha='CDS'),size=1) +
# geom_line(aes(y=sum_subst_density_optimal_to_nonoptimal_codon/sum_cible_density_optimal_to_nonoptimal_codon,color="POC -> non-POC",linetype='CDS',alpha='CDS'),size=1) +
geom_point(aes(y=density_optimal_to_nonoptimal_codon,fill="POC -> non-POC",pch='CDS',alpha='CDS'),size=3)+
geom_errorbar(aes(ymin=confint_low_density_optimal_to_nonoptimal_codon,
ymax=confint_high_density_optimal_to_nonoptimal_codon,color="POC -> non-POC"),
width=0.03,show.legend=FALSE) +
geom_line(aes(y=density_nonoptimal_to_optimal_codon,color="non-POC -> POC",linetype='CDS',alpha='CDS'),size=1) +
# geom_line(aes(y=sum_subst_density_nonoptimal_to_optimal_codon/sum_cible_density_nonoptimal_to_optimal_codon,color="non-POC -> POC",linetype='CDS',alpha='CDS'),size=1) +
geom_point(aes(y=density_nonoptimal_to_optimal_codon,fill="non-POC -> POC",pch='CDS',alpha='CDS'),size=3)+
geom_errorbar(aes(ymin=confint_low_density_nonoptimal_to_optimal_codon,
ymax=confint_high_density_nonoptimal_to_optimal_codon,color="non-POC -> POC"),
width=0.03,show.legend=FALSE)
pB = pB + theme_bw() + theme(
axis.title.x = element_text(color="black", size=0,family="economica"),
axis.title.y = element_text(color="black", size=30, family="economica"),
axis.text.y =  element_text(color="black", size=30, family="economica"),
axis.text.x =  element_text(color="black", size=0, family="economica"),
title =  element_text(color="black", size=0, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica")
) + xlab("Gene expression level (FPKM, log scale)") +
scale_x_log10(limits = c(0.01,1000),
breaks=c(0.005,0.01,0.1,0.5,1,5,10,50,100,1000,10000,50000),
labels=c(0.005,0.01,0.1,0.5,1,5,10,50,100,1000,10000,50000)) +
ylab(paste("SNPs density within CDSs")) + scale_fill_manual("",values=set_color_class,label=labels_name) +
scale_color_manual("",values=set_color_class) + scale_linetype_manual("",values=set_linetype_class) +
scale_shape_manual("",values=set_shape_class) + scale_alpha_manual("",values=set_alpha_class) +
guides(fill= guide_legend(override.aes = list(size=7,pch=21,byrow = TRUE),order = 2)
)  + annotation_logticks(sides="b")+
guides(color = FALSE, size = FALSE , linetype=F, pch=F, alpha=F) + theme(legend.position='none') + ylim(0.01,0.055)+
theme(legend.position = c(0.76, 0.9),
legend.background = element_rect(fill="NA"),
legend.spacing.x = unit(0.5, 'cm'),
legend.spacing.y = unit(0.5, 'cm')
)
pB
# data_10 = read.delim("data/data10_simulans_supp.tab")
data_10 = read.delim("data/data10_supp.tab")
dt_graph = data_10[ data_10$group == "POCs" ,]
labels_name = c( "POC -> non-POC" = paste( format(sum(dt_graph$sum_subst_density_optimal_to_nonoptimal_codon),big.mark=",",scientific=T)," substitutions POC -> non-POC",sep=""),
"non-POC -> POC"=paste( format(sum(dt_graph$sum_subst_density_nonoptimal_to_optimal_codon),big.mark=",",scientific=T)," substitutions non-POC -> POC",sep=""))
pE = ggplot(dt_graph,aes(x=fpkm)) + ggtitle("POCs")
pE = pE +
geom_line(aes(y=density_optimal_to_nonoptimal_codon,color="POC -> non-POC",linetype='CDS',alpha='CDS'),size=1) +
geom_point(aes(y=density_optimal_to_nonoptimal_codon,fill="POC -> non-POC",pch='CDS',alpha='CDS'),size=3)+
geom_errorbar(aes(ymin=confint_low_density_optimal_to_nonoptimal_codon,
ymax=confint_high_density_optimal_to_nonoptimal_codon,color="POC -> non-POC"),
width=0.03,show.legend=FALSE) +
geom_line(aes(y=density_nonoptimal_to_optimal_codon,color="non-POC -> POC",linetype='CDS',alpha='CDS'),size=1) +
geom_point(aes(y=density_nonoptimal_to_optimal_codon,fill="non-POC -> POC",pch='CDS',alpha='CDS'),size=3)+
geom_errorbar(aes(ymin=confint_low_density_nonoptimal_to_optimal_codon,
ymax=confint_high_density_nonoptimal_to_optimal_codon,color="non-POC -> POC"),
width=0.03,show.legend=FALSE)
pE = pE + theme_bw() + theme(
axis.title.x = element_text(color="black", size=0,family="economica"),
axis.title.y = element_text(color="black", size=30, family="economica"),
axis.text.y =  element_text(color="black", size=30, family="economica"),
axis.text.x =  element_text(color="black", size=0, family="economica"),
title =  element_text(color="black", size=0, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica")
) + xlab("Gene expression level (FPKM, log scale)") +
scale_x_log10(limits = c(0.01,1000),
breaks=c(0.005,0.01,0.1,0.5,1,5,10,50,100,1000,10000,50000),
labels=c(0.005,0.01,0.1,0.5,1,5,10,50,100,1000,10000,50000)) +
ylab(paste("Substitution rate within CDSs")) + scale_fill_manual("",values=set_color_class,label=labels_name) +
scale_color_manual("",values=set_color_class) + scale_linetype_manual("",values=set_linetype_class) +
scale_shape_manual("",values=set_shape_class) + scale_alpha_manual("",values=set_alpha_class) +
guides(fill= guide_legend(override.aes = list(size=7,pch=21,byrow = TRUE),order = 2)
)  + annotation_logticks(sides="b")+
guides(color = FALSE, size = FALSE , linetype=F, pch=F, alpha=F) + theme(legend.position='none') + ylim(0.005,0.05)+
theme(legend.position = c(0.7, 0.9),
legend.background = element_rect(fill="NA"),
legend.spacing.x = unit(0.5, 'cm'),
legend.spacing.y = unit(0.5, 'cm')
)
pE
pE = ggplot(dt_graph,aes(x=fpkm)) + ggtitle("POCs")
pE = pE +
geom_line(aes(y=density_optimal_to_nonoptimal_codon,color="POC -> non-POC",linetype='CDS',alpha='CDS'),size=1) +
geom_point(aes(y=density_optimal_to_nonoptimal_codon,fill="POC -> non-POC",pch='CDS',alpha='CDS'),size=3)+
geom_line(aes(y=sum_subst_density_optimal_to_nonoptimal_codon/sum_cible_density_optimal_to_nonoptimal_codon,color="POC -> non-POC",linetype='CDS',alpha='CDS'),size=1) +
geom_errorbar(aes(ymin=confint_low_density_optimal_to_nonoptimal_codon,
ymax=confint_high_density_optimal_to_nonoptimal_codon,color="POC -> non-POC"),
width=0.03,show.legend=FALSE) +
geom_line(aes(y=density_nonoptimal_to_optimal_codon,color="non-POC -> POC",linetype='CDS',alpha='CDS'),size=1) +
geom_point(aes(y=density_nonoptimal_to_optimal_codon,fill="non-POC -> POC",pch='CDS',alpha='CDS'),size=3)+
geom_errorbar(aes(ymin=confint_low_density_nonoptimal_to_optimal_codon,
ymax=confint_high_density_nonoptimal_to_optimal_codon,color="non-POC -> POC"),
width=0.03,show.legend=FALSE)
pE = pE + theme_bw() + theme(
axis.title.x = element_text(color="black", size=0,family="economica"),
axis.title.y = element_text(color="black", size=30, family="economica"),
axis.text.y =  element_text(color="black", size=30, family="economica"),
axis.text.x =  element_text(color="black", size=0, family="economica"),
title =  element_text(color="black", size=0, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica")
) + xlab("Gene expression level (FPKM, log scale)") +
scale_x_log10(limits = c(0.01,1000),
breaks=c(0.005,0.01,0.1,0.5,1,5,10,50,100,1000,10000,50000),
labels=c(0.005,0.01,0.1,0.5,1,5,10,50,100,1000,10000,50000)) +
ylab(paste("Substitution rate within CDSs")) + scale_fill_manual("",values=set_color_class,label=labels_name) +
scale_color_manual("",values=set_color_class) + scale_linetype_manual("",values=set_linetype_class) +
scale_shape_manual("",values=set_shape_class) + scale_alpha_manual("",values=set_alpha_class) +
guides(fill= guide_legend(override.aes = list(size=7,pch=21,byrow = TRUE),order = 2)
)  + annotation_logticks(sides="b")+
guides(color = FALSE, size = FALSE , linetype=F, pch=F, alpha=F) + theme(legend.position='none') + ylim(0.005,0.05)+
theme(legend.position = c(0.7, 0.9),
legend.background = element_rect(fill="NA"),
legend.spacing.x = unit(0.5, 'cm'),
legend.spacing.y = unit(0.5, 'cm')
)
pE
pE = ggplot(dt_graph,aes(x=fpkm)) + ggtitle("POCs")
pE = pE +
geom_line(aes(y=density_optimal_to_nonoptimal_codon,color="POC -> non-POC",linetype='CDS',alpha='CDS'),size=1) +
geom_point(aes(y=density_optimal_to_nonoptimal_codon,fill="POC -> non-POC",pch='CDS',alpha='CDS'),size=3)+
geom_line(aes(y=sum_subst_density_optimal_to_nonoptimal_codon/sum_cible_density_optimal_to_nonoptimal_codon,color="POC -> non-POC",linetype='CDS',alpha='CDS'),size=1) +
geom_errorbar(aes(ymin=confint_low_density_optimal_to_nonoptimal_codon,
ymax=confint_high_density_optimal_to_nonoptimal_codon,color="POC -> non-POC"),
width=0.03,show.legend=FALSE) +
geom_line(aes(y=density_nonoptimal_to_optimal_codon,color="non-POC -> POC",linetype='CDS',alpha='CDS'),size=1) +
geom_line(aes(y=sum_subst_density_nonoptimal_to_optimal_codon/sum_cible_density_nonoptimal_to_optimal_codon,color="non-POC -> POC",linetype='CDS',alpha='CDS'),size=1) +
geom_point(aes(y=density_nonoptimal_to_optimal_codon,fill="non-POC -> POC",pch='CDS',alpha='CDS'),size=3)+
geom_errorbar(aes(ymin=confint_low_density_nonoptimal_to_optimal_codon,
ymax=confint_high_density_nonoptimal_to_optimal_codon,color="non-POC -> POC"),
width=0.03,show.legend=FALSE)
pE = pE + theme_bw() + theme(
axis.title.x = element_text(color="black", size=0,family="economica"),
axis.title.y = element_text(color="black", size=30, family="economica"),
axis.text.y =  element_text(color="black", size=30, family="economica"),
axis.text.x =  element_text(color="black", size=0, family="economica"),
title =  element_text(color="black", size=0, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica")
) + xlab("Gene expression level (FPKM, log scale)") +
scale_x_log10(limits = c(0.01,1000),
breaks=c(0.005,0.01,0.1,0.5,1,5,10,50,100,1000,10000,50000),
labels=c(0.005,0.01,0.1,0.5,1,5,10,50,100,1000,10000,50000)) +
ylab(paste("Substitution rate within CDSs")) + scale_fill_manual("",values=set_color_class,label=labels_name) +
scale_color_manual("",values=set_color_class) + scale_linetype_manual("",values=set_linetype_class) +
scale_shape_manual("",values=set_shape_class) + scale_alpha_manual("",values=set_alpha_class) +
guides(fill= guide_legend(override.aes = list(size=7,pch=21,byrow = TRUE),order = 2)
)  + annotation_logticks(sides="b")+
guides(color = FALSE, size = FALSE , linetype=F, pch=F, alpha=F) + theme(legend.position='none') + ylim(0.005,0.05)+
theme(legend.position = c(0.7, 0.9),
legend.background = element_rect(fill="NA"),
legend.spacing.x = unit(0.5, 'cm'),
legend.spacing.y = unit(0.5, 'cm')
)
pE
# Generate Supplementary Figure 6, 7, 8 & 9
source("figure/figure_main_generator/library_path.R")
set_color_class = c("#E31A1C","#33A02C")
names(set_color_class) = c( "POC -> non-POC","non-POC -> POC")
set_shape_class = c(CDS=21,intron=24)
set_linetype_class = c(CDS="solid",intron="dashed")
set_alpha_class = c(CDS=1,intron=0.5)
###
data_11 = read.delim("data/data11_supp.tab")
dt_graph = data_11[ data_11$group == "POCs" ,]
# Pannel B
labels_name = c( "POC -> non-POC" = paste( format(sum(dt_graph$sum_subst_density_optimal_to_nonoptimal_codon),big.mark=",",scientific=T)," SNPs POC -> non-POC",sep=""),
"non-POC -> POC"=paste( format(sum(dt_graph$sum_subst_density_nonoptimal_to_optimal_codon),big.mark=",",scientific=T)," SNPs non-POC -> POC",sep=""))
pB = ggplot(dt_graph,aes(x=fpkm)) + ggtitle("POCs")
pB = pB +
geom_line(aes(y=density_optimal_to_nonoptimal_codon,color="POC -> non-POC",linetype='CDS',alpha='CDS'),size=1) +
# geom_line(aes(y=sum_subst_density_optimal_to_nonoptimal_codon/sum_cible_density_optimal_to_nonoptimal_codon,color="POC -> non-POC",linetype='CDS',alpha='CDS'),size=1) +
geom_point(aes(y=density_optimal_to_nonoptimal_codon,fill="POC -> non-POC",pch='CDS',alpha='CDS'),size=3)+
geom_errorbar(aes(ymin=confint_low_density_optimal_to_nonoptimal_codon,
ymax=confint_high_density_optimal_to_nonoptimal_codon,color="POC -> non-POC"),
width=0.03,show.legend=FALSE) +
geom_line(aes(y=density_nonoptimal_to_optimal_codon,color="non-POC -> POC",linetype='CDS',alpha='CDS'),size=1) +
# geom_line(aes(y=sum_subst_density_nonoptimal_to_optimal_codon/sum_cible_density_nonoptimal_to_optimal_codon,color="non-POC -> POC",linetype='CDS',alpha='CDS'),size=1) +
geom_point(aes(y=density_nonoptimal_to_optimal_codon,fill="non-POC -> POC",pch='CDS',alpha='CDS'),size=3)+
geom_errorbar(aes(ymin=confint_low_density_nonoptimal_to_optimal_codon,
ymax=confint_high_density_nonoptimal_to_optimal_codon,color="non-POC -> POC"),
width=0.03,show.legend=FALSE)
pB = pB + theme_bw() + theme(
axis.title.x = element_text(color="black", size=0,family="economica"),
axis.title.y = element_text(color="black", size=30, family="economica"),
axis.text.y =  element_text(color="black", size=30, family="economica"),
axis.text.x =  element_text(color="black", size=0, family="economica"),
title =  element_text(color="black", size=0, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica")
) + xlab("Gene expression level (FPKM, log scale)") +
scale_x_log10(limits = c(0.01,1000),
breaks=c(0.005,0.01,0.1,0.5,1,5,10,50,100,1000,10000,50000),
labels=c(0.005,0.01,0.1,0.5,1,5,10,50,100,1000,10000,50000)) +
ylab(paste("SNPs density within CDSs")) + scale_fill_manual("",values=set_color_class,label=labels_name) +
scale_color_manual("",values=set_color_class) + scale_linetype_manual("",values=set_linetype_class) +
scale_shape_manual("",values=set_shape_class) + scale_alpha_manual("",values=set_alpha_class) +
guides(fill= guide_legend(override.aes = list(size=7,pch=21,byrow = TRUE),order = 2)
)  + annotation_logticks(sides="b")+
guides(color = FALSE, size = FALSE , linetype=F, pch=F, alpha=F) + theme(legend.position='none') + ylim(0.01,0.055)+
theme(legend.position = c(0.76, 0.9),
legend.background = element_rect(fill="NA"),
legend.spacing.x = unit(0.5, 'cm'),
legend.spacing.y = unit(0.5, 'cm')
)
pB
jpeg(paste(path_pannel,"p6B.jpg",sep=""), width = 6000/1, height = 2800/1,res=600/1)
print(pB)
dev.off()
# Pannel C
labels_name = c( "POC -> non-POC" = paste( format(sum(dt_graph$sum_subst_density_optimal_to_nonoptimal_intron),big.mark=",",scientific=T)," SNPs POC -> non-POC",sep=""),
"non-POC -> POC"=paste( format(sum(dt_graph$sum_subst_density_nonoptimal_to_optimal_intron),big.mark=",",scientific=T)," SNPs non-POC -> POC",sep=""))
pC = ggplot(dt_graph,aes(x=fpkm)) + ggtitle("POCs")
pC = pC +
geom_line(aes(y=density_optimal_to_nonoptimal_intron,color="POC -> non-POC",linetype='intron',alpha='intron'),size=1) +
geom_point(aes(y=density_optimal_to_nonoptimal_intron,fill="POC -> non-POC",pch='intron',alpha='intron'),size=3)+
geom_errorbar(aes(ymin=confint_low_density_optimal_to_nonoptimal_intron,
ymax=confint_high_density_optimal_to_nonoptimal_intron,color="POC -> non-POC"),
width=0.03,show.legend=FALSE) +
geom_line(aes(y=density_nonoptimal_to_optimal_intron,color="non-POC -> POC",linetype='intron',alpha='intron'),size=1) +
geom_point(aes(y=density_nonoptimal_to_optimal_intron,fill="non-POC -> POC",pch='intron',alpha='intron'),size=3)+
geom_errorbar(aes(ymin=confint_low_density_nonoptimal_to_optimal_intron,
ymax=confint_high_density_nonoptimal_to_optimal_intron,color="non-POC -> POC"),
width=0.03,show.legend=FALSE)
pC = pC + theme_bw() + theme(
axis.title.x = element_text(color="black", size=30,family="economica"),
axis.title.y = element_text(color="black", size=30, family="economica"),
axis.text.y =  element_text(color="black", size=30, family="economica"),
axis.text.x =  element_text(color="black", size=27, family="economica"),
title =  element_text(color="black", size=0, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica")
) + xlab("Gene expression level (FPKM, log scale)") +
scale_x_log10(limits = c(0.01,1000),
breaks=c(0.005,0.01,0.1,0.5,1,5,10,50,100,1000,10000,50000),
labels=c(0.005,0.01,0.1,0.5,1,5,10,50,100,1000,10000,50000)) +
ylab(paste("SNPs density within introns")) + scale_fill_manual("",values=set_color_class,label=labels_name) +
scale_color_manual("",values=set_color_class) + scale_linetype_manual("",values=set_linetype_class) +
scale_shape_manual("",values=set_shape_class) + scale_alpha_manual("",values=set_alpha_class) +
guides(fill= guide_legend(override.aes = list(size=7,pch=21,byrow = TRUE),order = 2)
) +   theme(legend.spacing.y = unit(.2, 'cm'))  + theme(legend.position='top') + annotation_logticks(sides="b")+
guides(color = FALSE, size = FALSE , linetype=F, pch=F, alpha=F) + theme(legend.position='none') + ylim(0.01,0.055) +
theme(legend.position = c(0.76, 0.9),
legend.background = element_rect(fill="NA"),
legend.spacing.x = unit(0.5, 'cm'),
legend.spacing.y = unit(0.5, 'cm')
)
pC
jpeg(paste(path_pannel,"p6C.jpg",sep=""), width = 6000/1, height = 3000/1,res=600/1)
print(pC)
dev.off()
###
# data_10 = read.delim("data/data10_simulans_supp.tab")
data_10 = read.delim("data/data10_supp.tab")
dt_graph = data_10[ data_10$group == "POCs" ,]
# Pannel E
labels_name = c( "POC -> non-POC" = paste( format(sum(dt_graph$sum_subst_density_optimal_to_nonoptimal_codon),big.mark=",",scientific=T)," substitutions POC -> non-POC",sep=""),
"non-POC -> POC"=paste( format(sum(dt_graph$sum_subst_density_nonoptimal_to_optimal_codon),big.mark=",",scientific=T)," substitutions non-POC -> POC",sep=""))
pE = ggplot(dt_graph,aes(x=fpkm)) + ggtitle("POCs")
pE = pE +
geom_line(aes(y=density_optimal_to_nonoptimal_codon,color="POC -> non-POC",linetype='CDS',alpha='CDS'),size=1) +
# geom_line(aes(y=sum_subst_density_optimal_to_nonoptimal_codon/sum_cible_density_optimal_to_nonoptimal_codon,color="POC -> non-POC",linetype='CDS',alpha='CDS'),size=1) +
geom_point(aes(y=density_optimal_to_nonoptimal_codon,fill="POC -> non-POC",pch='CDS',alpha='CDS'),size=3)+
geom_errorbar(aes(ymin=confint_low_density_optimal_to_nonoptimal_codon,
ymax=confint_high_density_optimal_to_nonoptimal_codon,color="POC -> non-POC"),
width=0.03,show.legend=FALSE) +
geom_line(aes(y=density_nonoptimal_to_optimal_codon,color="non-POC -> POC",linetype='CDS',alpha='CDS'),size=1) +
# geom_line(aes(y=sum_subst_density_nonoptimal_to_optimal_codon/sum_cible_density_nonoptimal_to_optimal_codon,color="non-POC -> POC",linetype='CDS',alpha='CDS'),size=1) +
geom_point(aes(y=density_nonoptimal_to_optimal_codon,fill="non-POC -> POC",pch='CDS',alpha='CDS'),size=3)+
geom_errorbar(aes(ymin=confint_low_density_nonoptimal_to_optimal_codon,
ymax=confint_high_density_nonoptimal_to_optimal_codon,color="non-POC -> POC"),
width=0.03,show.legend=FALSE)
pE = pE + theme_bw() + theme(
axis.title.x = element_text(color="black", size=0,family="economica"),
axis.title.y = element_text(color="black", size=30, family="economica"),
axis.text.y =  element_text(color="black", size=30, family="economica"),
axis.text.x =  element_text(color="black", size=0, family="economica"),
title =  element_text(color="black", size=0, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica")
) + xlab("Gene expression level (FPKM, log scale)") +
scale_x_log10(limits = c(0.01,1000),
breaks=c(0.005,0.01,0.1,0.5,1,5,10,50,100,1000,10000,50000),
labels=c(0.005,0.01,0.1,0.5,1,5,10,50,100,1000,10000,50000)) +
ylab(paste("Substitution rate within CDSs")) + scale_fill_manual("",values=set_color_class,label=labels_name) +
scale_color_manual("",values=set_color_class) + scale_linetype_manual("",values=set_linetype_class) +
scale_shape_manual("",values=set_shape_class) + scale_alpha_manual("",values=set_alpha_class) +
guides(fill= guide_legend(override.aes = list(size=7,pch=21,byrow = TRUE),order = 2)
)  + annotation_logticks(sides="b")+
guides(color = FALSE, size = FALSE , linetype=F, pch=F, alpha=F) + theme(legend.position='none') + ylim(0.005,0.05)+
theme(legend.position = c(0.7, 0.9),
legend.background = element_rect(fill="NA"),
legend.spacing.x = unit(0.5, 'cm'),
legend.spacing.y = unit(0.5, 'cm')
)
pE
jpeg(paste(path_pannel,"p6E.jpg",sep=""), width = 6000/1, height = 2800/1,res=600/1)
print(pE)
dev.off()
# Pannel F
labels_name = c( "POC -> non-POC" = paste( format(sum(dt_graph$sum_subst_density_optimal_to_nonoptimal_intron),big.mark=",",scientific=T)," substitutions POC -> non-POC",sep=""),
"non-POC -> POC"=paste( format(sum(dt_graph$sum_subst_density_nonoptimal_to_optimal_intron),big.mark=",",scientific=T)," substitutions non-POC -> POC",sep=""))
pF = ggplot(dt_graph,aes(x=fpkm)) + ggtitle("POCs")
pF = pF +
geom_line(aes(y=density_optimal_to_nonoptimal_intron,color="POC -> non-POC",linetype='intron',alpha='intron'),size=1) +
geom_point(aes(y=density_optimal_to_nonoptimal_intron,fill="POC -> non-POC",pch='intron',alpha='intron'),size=3)+
geom_errorbar(aes(ymin=confint_low_density_optimal_to_nonoptimal_intron,
ymax=confint_high_density_optimal_to_nonoptimal_intron,color="POC -> non-POC"),
width=0.03,show.legend=FALSE) +
geom_line(aes(y=density_nonoptimal_to_optimal_intron,color="non-POC -> POC",linetype='intron',alpha='intron'),size=1) +
geom_point(aes(y=density_nonoptimal_to_optimal_intron,fill="non-POC -> POC",pch='intron',alpha='intron'),size=3)+
geom_errorbar(aes(ymin=confint_low_density_nonoptimal_to_optimal_intron,
ymax=confint_high_density_nonoptimal_to_optimal_intron,color="non-POC -> POC"),
width=0.03,show.legend=FALSE)
pF = pF + theme_bw() + theme(
axis.title.x = element_text(color="black", size=30,family="economica"),
axis.title.y = element_text(color="black", size=30, family="economica"),
axis.text.y =  element_text(color="black", size=30, family="economica"),
axis.text.x =  element_text(color="black", size=27, family="economica"),
title =  element_text(color="black", size=0, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica")
) + xlab("Gene expression level (FPKM, log scale)") +
scale_x_log10(limits = c(0.01,1000),
breaks=c(0.005,0.01,0.1,0.5,1,5,10,50,100,1000,10000,50000),
labels=c(0.005,0.01,0.1,0.5,1,5,10,50,100,1000,10000,50000)) +
ylab(paste("Substitution rate within introns")) + scale_fill_manual("",values=set_color_class,label=labels_name) +
scale_color_manual("",values=set_color_class) + scale_linetype_manual("",values=set_linetype_class) +
scale_shape_manual("",values=set_shape_class) + scale_alpha_manual("",values=set_alpha_class) +
guides(fill= guide_legend(override.aes = list(size=7,pch=21,byrow = TRUE),order = 2)
) +   theme(legend.spacing.y = unit(.2, 'cm'))  + theme(legend.position='top') + annotation_logticks(sides="b")+
guides(color = FALSE, size = FALSE , linetype=F, pch=F, alpha=F) + theme(legend.position='none') + ylim(0.005,0.05) +
theme(legend.position = c(0.7, 0.9),
legend.background = element_rect(fill="NA"),
legend.spacing.x = unit(0.5, 'cm'),
legend.spacing.y = unit(0.5, 'cm')
)
pF
data_11 = data_11[c("fpkm","sum_cible_density_nonoptimal_to_nonoptimal_codon","sum_subst_density_nonoptimal_to_nonoptimal_codon","density_nonoptimal_to_nonoptimal_codon")]
colnames(data_11)
data_11 = data_11[c("fpkm","sum_cible_density_nonoptimal_to_nonoptimal_codon","sum_subst_density_nonoptimal_to_nonoptimal_codon","density_nonoptimal_to_nonoptimal_codon")]
colnames(data_11) = c("fpkm","cible","substitutions")
optimal_to_nonoptimal
data_11 = data_11[c("fpkm",
"sum_subst_density_optimal_to_nonoptimal_codon",
"sum_subst_density_nonoptimal_to_optimal_codon"
)]
colnames(data_11) = c("fpkm","substitutions_POC_to_nonPOC",
"substitutions_nonPOC_to_POC")
optimal_to_nonoptimal
# data_10 = read.delim("data/data10_simulans_supp.tab")
data_10 = read.delim("data/data10_supp.tab")
dt_graph = data_10[ data_10$group == "POCs" ,]
data_11 = read.delim("data/data11_supp.tab")
dt_graph = data_11[ data_11$group == "POCs" ,]
data_11 = data_11[c("fpkm",
"sum_subst_density_optimal_to_nonoptimal_codon",
"sum_subst_density_nonoptimal_to_optimal_codon"
)]
colnames(data_11) = c("fpkm","substitutions_POC_to_nonPOC",
"substitutions_nonPOC_to_POC")
colnames(data_10) = c("fpkm","snps_POC_to_nonPOC",
"snps_nonPOC_to_POC")
# data_10 = read.delim("data/data10_simulans_supp.tab")
data_10 = read.delim("data/data10_supp.tab")
dt_graph = data_10[ data_10$group == "POCs" ,]
data_10 = data_10[c("fpkm",
"sum_subst_density_optimal_to_nonoptimal_codon",
"sum_subst_density_nonoptimal_to_optimal_codon"
)]
colnames(data_10) = c("fpkm","snps_POC_to_nonPOC",
"snps_nonPOC_to_POC")
data_10
data_11
cbind(data_10,data_11)
dt = cbind(data_10,data_11)
dt = dt[,c(1,2,3,5,6)]
dt
write.table(dt,"dt_substitutions_snps.tab",quote=F,row.names = F,sep="\t")
data_11 = read.delim("data/data11_supp.tab")
data_10 = read.delim("data/data10_supp.tab")
data_11 = read.delim("data/data11_supp.tab")
data_10 = read.delim("data/data10_supp.tab")
data_11$intron
data_11 = data_11[c("fpkm",
"sum_subst_density_optimal_to_nonoptimal_codon",
"sum_subst_density_nonoptimal_to_optimal_codon",
"sum_subst_density_optimal_to_nonoptimal_intron",
"sum_subst_density_nonoptimal_to_optimal_intron"
)]
colnames(data_11) = c("fpkm","substitutions_POC_to_nonPOC_codon",
"substitutions_nonPOC_to_POC_codon",
"substitutions_POC_to_nonPOC_intron",
"substitutions_nonPOC_to_POC_intron")
data_10 = data_10[c("fpkm",
"sum_subst_density_optimal_to_nonoptimal_codon",
"sum_subst_density_nonoptimal_to_optimal_codon",
"sum_subst_density_optimal_to_nonoptimal_intron",
"sum_subst_density_nonoptimal_to_optimal_intron"
)]
colnames(data_10) = c("fpkm","snps_POC_to_nonPOC_codon",
"snps_nonPOC_to_POC_codon",
"snps_POC_to_nonPOC_intron",
"snps_nonPOC_to_POC_intron")
dt = cbind(data_10,data_11)
dt
data_11 = read.delim("data/data11_supp.tab")
data_10 = read.delim("data/data10_supp.tab")
data_11$intron
data_11 = data_11[c("fpkm",
"sum_subst_density_optimal_to_nonoptimal_codon",
"sum_subst_density_nonoptimal_to_optimal_codon",
"sum_subst_density_optimal_to_nonoptimal_intron",
"sum_subst_density_nonoptimal_to_optimal_intron"
)]
colnames(data_11) = c("fpkm","substitutions_POC_to_nonPOC_codon",
"substitutions_nonPOC_to_POC_codon",
"substitutions_POC_to_nonPOC_intron",
"substitutions_nonPOC_to_POC_intron")
data_10 = data_10[c("fpkm",
"sum_subst_density_optimal_to_nonoptimal_codon",
"sum_subst_density_nonoptimal_to_optimal_codon",
"sum_subst_density_optimal_to_nonoptimal_intron",
"sum_subst_density_nonoptimal_to_optimal_intron"
)]
colnames(data_10) = c("fpkm","snps_POC_to_nonPOC_codon",
"snps_nonPOC_to_POC_codon",
"snps_POC_to_nonPOC_intron",
"snps_nonPOC_to_POC_intron")
write.table(dt,"dt_substitutions_snps.tab",quote=F,row.names = F,sep="\t")
View(dt)
sum(dt$snps_POC_to_nonPOC_codon)
sum(dt$substitutions_nonPOC_to_POC_codon)
data_11 = read.delim("data/data11_supp.tab")
data_10 = read.delim("data/data10_supp.tab")
data_11$intron
data_11 = data_11[c("fpkm",
"sum_subst_density_optimal_to_nonoptimal_codon",
"sum_subst_density_nonoptimal_to_optimal_codon",
"sum_subst_density_optimal_to_nonoptimal_intron",
"sum_subst_density_nonoptimal_to_optimal_intron"
)]
colnames(data_11) = c("fpkm","snps_POC_to_nonPOC_codon",
"snps_nonPOC_to_POC_codon",
"snps_POC_to_nonPOC_intron",
"snps_nonPOC_to_POC_intron")
data_10 = data_10[c("fpkm",
"sum_subst_density_optimal_to_nonoptimal_codon",
"sum_subst_density_nonoptimal_to_optimal_codon",
"sum_subst_density_optimal_to_nonoptimal_intron",
"sum_subst_density_nonoptimal_to_optimal_intron"
)]
colnames(data_10) = c("fpkm","substitutions_POC_to_nonPOC_codon",
"substitutions_nonPOC_to_POC_codon",
"substitutions_POC_to_nonPOC_intron",
"substitutions_nonPOC_to_POC_intron")
dt = cbind(data_10,data_11)
# dt = dt[,c(1,2,3,5,6)]
write.table(dt,"dt_substitutions_snps.tab",quote=F,row.names = F,sep="\t")
sum(dt$snps_POC_to_nonPOC_codon)
sum(dt$substitutions_nonPOC_to_POC_codon)
dt
table = read.delim("/home/fbenitiere/2024-translational_selection/data/tRNA_abundance.tab")
View(table)
table$species=rownames(table)
# Generate Figure 3
source("figure/figure_main_generator/library_path.R")
# Pannel 3 B
code = read.delim(paste("data/standard_genetic_code.tab",sep=""))
rownames(code) = code$codon
data12 = read.delim("data/data12_supp.tab")
View(data12)
=======
guides(fill="none",linetype="none",shape="none") +
facet_wrap(~species)
pA
jpeg(paste(path_pannel,"pS9A.jpg",sep=""),  width = 8500/2,  5400/2,res=1000/1.8)
print(pA)
dev.off()
# Figure 4
imgA = load.image(paste(path_pannel,"pS9A.jpg",sep="") )
{
pdf(file= paste(path_figure,"Figure9_supp.pdf",sep=""), width=9, height=5.6)
m = matrix(rep(NA,100*100), nrow=100)
m
par(mar=c(1, 1, 2, 0))
plot(imgA, axes=FALSE)
dev.off()
}
jpeg(paste(path_pannel,"pS9A.jpg",sep=""),  width = 8500/2,  5400/2,res=700/1.8)
print(pA)
dev.off()
jpeg(paste(path_pannel,"pS9A.jpg",sep=""),  width = 8500/2,  5400/2,res=600/1.8)
print(pA)
dev.off()
jpeg(paste(path_pannel,"pS9A.jpg",sep=""),  width = 10500/2,  5400/2,res=600/1.8)
print(pA)
dev.off()
# Figure 4
imgA = load.image(paste(path_pannel,"pS9A.jpg",sep="") )
{
pdf(file= paste(path_figure,"Figure9_supp.pdf",sep=""), width=9, height=5.6)
m = matrix(rep(NA,100*100), nrow=100)
m
par(mar=c(1, 1, 2, 0))
plot(imgA, axes=FALSE)
dev.off()
}
{
pdf(file= paste(path_figure,"Figure9_supp.pdf",sep=""), width=9, height=5)
m = matrix(rep(NA,100*100), nrow=100)
m
par(mar=c(1, 1, 2, 0))
plot(imgA, axes=FALSE)
dev.off()
}
pA = ggplot(dt_graph ,
aes(x=fpkm ,y=freq*100,fill=paste(set,categorie),col=paste(set,categorie)))  + geom_point(alpha=0)+
geom_line(data=dt_graph,size=2,aes(linetype=paste(set,categorie))) +
geom_point(data=dt_graph,pch=21,col="black",size=3)+
scale_fill_manual(values=set_color[c(2,1,4,3)]) +
scale_color_manual(values=set_color[c(2,1,4,3)]) +
scale_shape_manual(values=c(21,22,24,23,25,20))+
scale_linetype_manual(values=c("solid","solid","solid","solid"))+
xlab("Gene expression level (FPKM, log scale)") + ylab("Codon set frequency (%)") + theme_bw() + theme(
axis.title.x = element_text(color="black", size=25,family="economica"),
axis.title.y = element_text(color="black", size=25, family="economica"),
axis.text.y =  element_text(color="black", size=23, family="economica"),
axis.text.x =  element_text(color="black", size=23, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica"),
legend.spacing.y = unit(1.5, 'cm'),
legend.spacing.x = unit(-1, 'cm'),
strip.text = element_text(size=15,face="italic")
)+labs(fill='Categories',color='Categories',shape='',linetype='')+
guides(fill = guide_legend(override.aes = list(pch=NA),order = 1),
color = guide_legend(order = 1),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
) + scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+ ylim(0.2*100,0.8*100) +
annotation_logticks(sides = "b")+
guides(fill="none",linetype="none",shape="none") +
facet_wrap(~species)
pA
pA = ggplot(dt_graph ,
aes(x=fpkm ,y=freq*100,fill=paste(set,categorie),col=paste(set,categorie)))  + geom_point(alpha=0)+
geom_line(data=dt_graph,size=2,aes(linetype=paste(set,categorie))) +
geom_point(data=dt_graph,pch=21,col="black",size=3)+
scale_fill_manual(values=set_color[c(2,1,4,3)]) +
scale_color_manual(values=set_color[c(2,1,4,3)]) +
scale_shape_manual(values=c(21,22,24,23,25,20))+
scale_linetype_manual(values=c("solid","solid","solid","solid"))+
xlab("Gene expression level (FPKM, log scale)") + ylab("Codon set frequency (%)") + theme_bw() + theme(
axis.title.x = element_text(color="black", size=25,family="economica"),
axis.title.y = element_text(color="black", size=25, family="economica"),
axis.text.y =  element_text(color="black", size=23, family="economica",hjust=-1),
axis.text.x =  element_text(color="black", size=23, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica"),
strip.text = element_text(size=15,face="italic")
)+labs(fill='Categories',color='Categories',shape='',linetype='')+
guides(fill = guide_legend(override.aes = list(pch=NA),order = 1),
color = guide_legend(order = 1),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
) + scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+ ylim(0.2*100,0.8*100) +
annotation_logticks(sides = "b")+
guides(fill="none",linetype="none",shape="none") +
facet_wrap(~species)
pA
jpeg(paste(path_pannel,"pS9A.jpg",sep=""),  width = 10500/2,  5400/2,res=600/1.8)
print(pA)
dev.off()
pA = ggplot(dt_graph ,
aes(x=fpkm ,y=freq*100,fill=paste(set,categorie),col=paste(set,categorie)))  + geom_point(alpha=0)+
geom_line(data=dt_graph,size=2,aes(linetype=paste(set,categorie))) +
geom_point(data=dt_graph,pch=21,col="black",size=3)+
scale_fill_manual(values=set_color[c(2,1,4,3)]) +
scale_color_manual(values=set_color[c(2,1,4,3)]) +
scale_shape_manual(values=c(21,22,24,23,25,20))+
scale_linetype_manual(values=c("solid","solid","solid","solid"))+
xlab("Gene expression level (FPKM, log scale)") + ylab("Codon set frequency (%)") + theme_bw() + theme(
axis.title.x = element_text(color="black", size=25,family="economica"),
axis.title.y = element_text(color="black", size=25, family="economica"),
axis.text.y =  element_text(color="black", size=23, family="economica",hjust=-10),
axis.text.x =  element_text(color="black", size=23, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica"),
strip.text = element_text(size=15,face="italic")
)+labs(fill='Categories',color='Categories',shape='',linetype='')+
guides(fill = guide_legend(override.aes = list(pch=NA),order = 1),
color = guide_legend(order = 1),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
) + scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+ ylim(0.2*100,0.8*100) +
annotation_logticks(sides = "b")+
guides(fill="none",linetype="none",shape="none") +
facet_wrap(~species)
pA
jpeg(paste(path_pannel,"pS9A.jpg",sep=""),  width = 10500/2,  5400/2,res=600/1.8)
print(pA)
dev.off()
pA = ggplot(dt_graph ,
aes(x=fpkm ,y=freq*100,fill=paste(set,categorie),col=paste(set,categorie)))  + geom_point(alpha=0)+
geom_line(data=dt_graph,size=2,aes(linetype=paste(set,categorie))) +
geom_point(data=dt_graph,pch=21,col="black",size=3)+
scale_fill_manual(values=set_color[c(2,1,4,3)]) +
scale_color_manual(values=set_color[c(2,1,4,3)]) +
scale_shape_manual(values=c(21,22,24,23,25,20))+
scale_linetype_manual(values=c("solid","solid","solid","solid"))+
xlab("Gene expression level (FPKM, log scale)") + ylab("Codon set frequency (%)") + theme_bw() + theme(
axis.title.x = element_text(color="black", size=25,family="economica"),
axis.title.y = element_text(color="black", size=25, family="economica",hjust=-10),
axis.text.y =  element_text(color="black", size=23, family="economica"),
axis.text.x =  element_text(color="black", size=23, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica"),
strip.text = element_text(size=15,face="italic")
)+labs(fill='Categories',color='Categories',shape='',linetype='')+
guides(fill = guide_legend(override.aes = list(pch=NA),order = 1),
color = guide_legend(order = 1),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
) + scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+ ylim(0.2*100,0.8*100) +
annotation_logticks(sides = "b")+
guides(fill="none",linetype="none",shape="none") +
facet_wrap(~species)
pA
pA = ggplot(dt_graph ,
aes(x=fpkm ,y=freq*100,fill=paste(set,categorie),col=paste(set,categorie)))  + geom_point(alpha=0)+
geom_line(data=dt_graph,size=2,aes(linetype=paste(set,categorie))) +
geom_point(data=dt_graph,pch=21,col="black",size=3)+
scale_fill_manual(values=set_color[c(2,1,4,3)]) +
scale_color_manual(values=set_color[c(2,1,4,3)]) +
scale_shape_manual(values=c(21,22,24,23,25,20))+
scale_linetype_manual(values=c("solid","solid","solid","solid"))+
xlab("Gene expression level (FPKM, log scale)") + ylab("Codon set frequency (%)") + theme_bw() + theme(
axis.title.x = element_text(color="black", size=25,family="economica"),
axis.title.y = element_text(color="black", size=25, family="economica",hjust=-1),
axis.text.y =  element_text(color="black", size=23, family="economica"),
axis.text.x =  element_text(color="black", size=23, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica"),
strip.text = element_text(size=15,face="italic")
)+labs(fill='Categories',color='Categories',shape='',linetype='')+
guides(fill = guide_legend(override.aes = list(pch=NA),order = 1),
color = guide_legend(order = 1),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
) + scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+ ylim(0.2*100,0.8*100) +
annotation_logticks(sides = "b")+
guides(fill="none",linetype="none",shape="none") +
facet_wrap(~species)
pA
pA = ggplot(dt_graph ,
aes(x=fpkm ,y=freq*100,fill=paste(set,categorie),col=paste(set,categorie)))  + geom_point(alpha=0)+
geom_line(data=dt_graph,size=2,aes(linetype=paste(set,categorie))) +
geom_point(data=dt_graph,pch=21,col="black",size=3)+
scale_fill_manual(values=set_color[c(2,1,4,3)]) +
scale_color_manual(values=set_color[c(2,1,4,3)]) +
scale_shape_manual(values=c(21,22,24,23,25,20))+
scale_linetype_manual(values=c("solid","solid","solid","solid"))+
xlab("Gene expression level (FPKM, log scale)") + ylab("Codon set frequency (%)") + theme_bw() + theme(
axis.title.x = element_text(color="black", size=25,family="economica"),
axis.title.y = element_text(color="black", size=25, family="economica",vjust=-1),
axis.text.y =  element_text(color="black", size=23, family="economica"),
axis.text.x =  element_text(color="black", size=23, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica"),
strip.text = element_text(size=15,face="italic")
)+labs(fill='Categories',color='Categories',shape='',linetype='')+
guides(fill = guide_legend(override.aes = list(pch=NA),order = 1),
color = guide_legend(order = 1),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
) + scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+ ylim(0.2*100,0.8*100) +
annotation_logticks(sides = "b")+
guides(fill="none",linetype="none",shape="none") +
facet_wrap(~species)
pA
pA = ggplot(dt_graph ,
aes(x=fpkm ,y=freq*100,fill=paste(set,categorie),col=paste(set,categorie)))  + geom_point(alpha=0)+
geom_line(data=dt_graph,size=2,aes(linetype=paste(set,categorie))) +
geom_point(data=dt_graph,pch=21,col="black",size=3)+
scale_fill_manual(values=set_color[c(2,1,4,3)]) +
scale_color_manual(values=set_color[c(2,1,4,3)]) +
scale_shape_manual(values=c(21,22,24,23,25,20))+
scale_linetype_manual(values=c("solid","solid","solid","solid"))+
xlab("Gene expression level (FPKM, log scale)") + ylab("Codon set frequency (%)") + theme_bw() + theme(
axis.title.x = element_text(color="black", size=25,family="economica"),
axis.title.y = element_text(color="black", size=25, family="economica",vjust=1),
axis.text.y =  element_text(color="black", size=23, family="economica"),
axis.text.x =  element_text(color="black", size=23, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica"),
strip.text = element_text(size=15,face="italic")
)+labs(fill='Categories',color='Categories',shape='',linetype='')+
guides(fill = guide_legend(override.aes = list(pch=NA),order = 1),
color = guide_legend(order = 1),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
) + scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+ ylim(0.2*100,0.8*100) +
annotation_logticks(sides = "b")+
guides(fill="none",linetype="none",shape="none") +
facet_wrap(~species)
pA
jpeg(paste(path_pannel,"pS9A.jpg",sep=""),  width = 10500/2,  5400/2,res=600/1.8)
print(pA)
dev.off()
pA = ggplot(dt_graph ,
aes(x=fpkm ,y=freq*100,fill=paste(set,categorie),col=paste(set,categorie)))  + geom_point(alpha=0)+
geom_line(data=dt_graph,size=2,aes(linetype=paste(set,categorie))) +
geom_point(data=dt_graph,pch=21,col="black",size=3)+
scale_fill_manual(values=set_color[c(2,1,4,3)]) +
scale_color_manual(values=set_color[c(2,1,4,3)]) +
scale_shape_manual(values=c(21,22,24,23,25,20))+
scale_linetype_manual(values=c("solid","solid","solid","solid"))+
xlab("Gene expression level (FPKM, log scale)") + ylab("Codon set frequency (%)") + theme_bw() + theme(
axis.title.x = element_text(color="black", size=25,family="economica"),
axis.title.y = element_text(color="black", size=25, family="economica",vjust=10),
axis.text.y =  element_text(color="black", size=23, family="economica"),
axis.text.x =  element_text(color="black", size=23, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica"),
strip.text = element_text(size=15,face="italic")
)+labs(fill='Categories',color='Categories',shape='',linetype='')+
guides(fill = guide_legend(override.aes = list(pch=NA),order = 1),
color = guide_legend(order = 1),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
) + scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+ ylim(0.2*100,0.8*100) +
annotation_logticks(sides = "b")+
guides(fill="none",linetype="none",shape="none") +
facet_wrap(~species)
pA
pA = ggplot(dt_graph ,
aes(x=fpkm ,y=freq*100,fill=paste(set,categorie),col=paste(set,categorie)))  + geom_point(alpha=0)+
geom_line(data=dt_graph,size=2,aes(linetype=paste(set,categorie))) +
geom_point(data=dt_graph,pch=21,col="black",size=3)+
scale_fill_manual(values=set_color[c(2,1,4,3)]) +
scale_color_manual(values=set_color[c(2,1,4,3)]) +
scale_shape_manual(values=c(21,22,24,23,25,20))+
scale_linetype_manual(values=c("solid","solid","solid","solid"))+
xlab("Gene expression level (FPKM, log scale)") + ylab("Codon set frequency (%)") + theme_bw() + theme(
axis.title.x = element_text(color="black", size=25,family="economica"),
axis.title.y = element_text(color="black", size=25, family="economica",vjust=2),
axis.text.y =  element_text(color="black", size=23, family="economica"),
axis.text.x =  element_text(color="black", size=23, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica"),
strip.text = element_text(size=15,face="italic")
)+labs(fill='Categories',color='Categories',shape='',linetype='')+
guides(fill = guide_legend(override.aes = list(pch=NA),order = 1),
color = guide_legend(order = 1),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
) + scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+ ylim(0.2*100,0.8*100) +
annotation_logticks(sides = "b")+
guides(fill="none",linetype="none",shape="none") +
facet_wrap(~species)
pA
jpeg(paste(path_pannel,"pS9A.jpg",sep=""),  width = 10500/2,  5400/2,res=600/1.8)
print(pA)
dev.off()
pA = ggplot(dt_graph ,
aes(x=fpkm ,y=freq*100,fill=paste(set,categorie),col=paste(set,categorie)))  + geom_point(alpha=0)+
geom_line(data=dt_graph,size=2,aes(linetype=paste(set,categorie))) +
geom_point(data=dt_graph,pch=21,col="black",size=3)+
scale_fill_manual(values=set_color[c(2,1,4,3)]) +
scale_color_manual(values=set_color[c(2,1,4,3)]) +
scale_shape_manual(values=c(21,22,24,23,25,20))+
scale_linetype_manual(values=c("solid","solid","solid","solid"))+
xlab("Gene expression level (FPKM, log scale)") + ylab("Codon set frequency (%)") + theme_bw() + theme(
axis.title.x = element_text(color="black", size=25,family="economica",hjust=2),
axis.title.y = element_text(color="black", size=25, family="economica",vjust=2),
axis.text.y =  element_text(color="black", size=23, family="economica"),
axis.text.x =  element_text(color="black", size=23, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica"),
strip.text = element_text(size=15,face="italic")
)+labs(fill='Categories',color='Categories',shape='',linetype='')+
guides(fill = guide_legend(override.aes = list(pch=NA),order = 1),
color = guide_legend(order = 1),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
) + scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+ ylim(0.2*100,0.8*100) +
annotation_logticks(sides = "b")+
guides(fill="none",linetype="none",shape="none") +
facet_wrap(~species)
pA
pA = ggplot(dt_graph ,
aes(x=fpkm ,y=freq*100,fill=paste(set,categorie),col=paste(set,categorie)))  + geom_point(alpha=0)+
geom_line(data=dt_graph,size=2,aes(linetype=paste(set,categorie))) +
geom_point(data=dt_graph,pch=21,col="black",size=3)+
scale_fill_manual(values=set_color[c(2,1,4,3)]) +
scale_color_manual(values=set_color[c(2,1,4,3)]) +
scale_shape_manual(values=c(21,22,24,23,25,20))+
scale_linetype_manual(values=c("solid","solid","solid","solid"))+
xlab("Gene expression level (FPKM, log scale)") + ylab("Codon set frequency (%)") + theme_bw() + theme(
axis.title.x = element_text(color="black", size=25,family="economica",vjust=2),
axis.title.y = element_text(color="black", size=25, family="economica",vjust=2),
axis.text.y =  element_text(color="black", size=23, family="economica"),
axis.text.x =  element_text(color="black", size=23, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica"),
strip.text = element_text(size=15,face="italic")
)+labs(fill='Categories',color='Categories',shape='',linetype='')+
guides(fill = guide_legend(override.aes = list(pch=NA),order = 1),
color = guide_legend(order = 1),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
) + scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+ ylim(0.2*100,0.8*100) +
annotation_logticks(sides = "b")+
guides(fill="none",linetype="none",shape="none") +
facet_wrap(~species)
pA
jpeg(paste(path_pannel,"pS9A.jpg",sep=""),  width = 10500/2,  5400/2,res=600/1.8)
print(pA)
dev.off()
pA = ggplot(dt_graph ,
aes(x=fpkm ,y=freq*100,fill=paste(set,categorie),col=paste(set,categorie)))  + geom_point(alpha=0)+
geom_line(data=dt_graph,size=2,aes(linetype=paste(set,categorie))) +
geom_point(data=dt_graph,pch=21,col="black",size=3)+
scale_fill_manual(values=set_color[c(2,1,4,3)]) +
scale_color_manual(values=set_color[c(2,1,4,3)]) +
scale_shape_manual(values=c(21,22,24,23,25,20))+
scale_linetype_manual(values=c("solid","solid","solid","solid"))+
xlab("Gene expression level (FPKM, log scale)") + ylab("Codon set frequency (%)") + theme_bw() + theme(
axis.title.x = element_text(color="black", size=25,family="economica",vjust=-2),
axis.title.y = element_text(color="black", size=25, family="economica",vjust=2),
axis.text.y =  element_text(color="black", size=23, family="economica"),
axis.text.x =  element_text(color="black", size=23, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica"),
strip.text = element_text(size=15,face="italic")
)+labs(fill='Categories',color='Categories',shape='',linetype='')+
guides(fill = guide_legend(override.aes = list(pch=NA),order = 1),
color = guide_legend(order = 1),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
) + scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+ ylim(0.2*100,0.8*100) +
annotation_logticks(sides = "b")+
guides(fill="none",linetype="none",shape="none") +
facet_wrap(~species)
pA
jpeg(paste(path_pannel,"pS9A.jpg",sep=""),  width = 10500/2,  5400/2,res=600/1.8)
print(pA)
dev.off()
pA = ggplot(dt_graph ,
aes(x=fpkm ,y=freq*100,fill=paste(set,categorie),col=paste(set,categorie)))  + geom_point(alpha=0)+
geom_line(data=dt_graph,size=2,aes(linetype=paste(set,categorie))) +
geom_point(data=dt_graph,pch=21,col="black",size=3)+
scale_fill_manual(values=set_color[c(2,1,4,3)]) +
scale_color_manual(values=set_color[c(2,1,4,3)]) +
scale_shape_manual(values=c(21,22,24,23,25,20))+
scale_linetype_manual(values=c("solid","solid","solid","solid"))+
xlab("Gene expression level (FPKM, log scale)") + ylab("Codon set frequency (%)") + theme_bw() + theme(
axis.title.x = element_text(color="black", size=25,family="economica",vjust=-1),
axis.title.y = element_text(color="black", size=25, family="economica",vjust=2),
axis.text.y =  element_text(color="black", size=23, family="economica"),
axis.text.x =  element_text(color="black", size=23, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica"),
strip.text = element_text(size=15,face="italic")
)+labs(fill='Categories',color='Categories',shape='',linetype='')+
guides(fill = guide_legend(override.aes = list(pch=NA),order = 1),
color = guide_legend(order = 1),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
) + scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+ ylim(0.2*100,0.8*100) +
annotation_logticks(sides = "b")+
guides(fill="none",linetype="none",shape="none") +
facet_wrap(~species)
pA
jpeg(paste(path_pannel,"pS9A.jpg",sep=""),  width = 10500/2,  5400/2,res=600/1.8)
print(pA)
dev.off()
pA = ggplot(dt_graph ,
aes(x=fpkm ,y=freq*100,fill=paste(set,categorie),col=paste(set,categorie)))  + geom_point(alpha=0)+
geom_line(data=dt_graph,size=2,aes(linetype=paste(set,categorie))) +
geom_point(data=dt_graph,pch=21,col="black",size=3)+
scale_fill_manual(values=set_color[c(2,1,4,3)]) +
scale_color_manual(values=set_color[c(2,1,4,3)]) +
scale_shape_manual(values=c(21,22,24,23,25,20))+
scale_linetype_manual(values=c("solid","solid","solid","solid"))+
xlab("Gene expression level (FPKM, log scale)") + ylab("Codon set frequency (%)") + theme_bw() + theme(
axis.title.x = element_text(color="black", size=25,family="economica",vjust=0),
axis.title.y = element_text(color="black", size=25, family="economica",vjust=2),
axis.text.y =  element_text(color="black", size=23, family="economica"),
axis.text.x =  element_text(color="black", size=23, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica"),
strip.text = element_text(size=15,face="italic")
)+labs(fill='Categories',color='Categories',shape='',linetype='')+
guides(fill = guide_legend(override.aes = list(pch=NA),order = 1),
color = guide_legend(order = 1),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
) + scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+ ylim(0.2*100,0.8*100) +
annotation_logticks(sides = "b")+
guides(fill="none",linetype="none",shape="none") +
facet_wrap(~species)
pA
jpeg(paste(path_pannel,"pS9A.jpg",sep=""),  width = 10500/2,  5400/2,res=600/1.8)
print(pA)
dev.off()
# Generate Figure 4
source("figure/figure_supp_generator/library_path.R")
# Pannel 4 A
data5 = read.delim("data/data5_supp.tab")
data5$gene_set = str_replace_all(data5$gene_set,"all,","genes,")
data5[data5$categorie == "POC-matching triplets (POCMT)",]$categorie = "control"
data5[data5$categorie == "Putative optimal codons (POC)",]$categorie = ""
# dt_graph = data5[ data5$species "Musca_domestica" & data5$set != "POCs",]
dt_graph = data5[  data5$set != "POCs",]
dt_graph$species = paste(str_replace_all(dt_graph$species,"_"," "),sep="")
pA = ggplot(dt_graph ,
aes(x=fpkm ,y=freq*100,fill=paste(set,categorie),col=paste(set,categorie)))  + geom_point(alpha=0)+
geom_line(data=dt_graph,size=2,aes(linetype=paste(set,categorie))) +
geom_point(data=dt_graph,pch=21,col="black",size=3)+
scale_fill_manual(values=set_color[c(2,1,4,3)]) +
scale_color_manual(values=set_color[c(2,1,4,3)]) +
scale_shape_manual(values=c(21,22,24,23,25,20))+
scale_linetype_manual(values=c("solid","solid","solid","solid"))+
xlab("Gene expression level (FPKM, log scale)") + ylab("Codon set frequency (%)") + theme_bw() + theme(
axis.title.x = element_text(color="black", size=25,family="economica",vjust=0),
axis.title.y = element_text(color="black", size=25, family="economica",vjust=2),
axis.text.y =  element_text(color="black", size=23, family="economica"),
axis.text.x =  element_text(color="black", size=23, family="economica"),
title =  element_text(color="black", size=25, family="economica"),
legend.text =  element_text(color="black", size=25, family="economica"),
strip.text = element_text(size=15,face="italic")
)+labs(fill='Categories',color='Categories',shape='',linetype='')+
guides(fill = guide_legend(override.aes = list(pch=NA),order = 1),
color = guide_legend(order = 1),
linetype = guide_legend(order = 2),
shape = guide_legend(order = 2),
) + scale_x_log10(
breaks=c(0.01,0.1,1,10,100,1000,10000,50000),
labels=c(0.01,0.1,1,10,100,1000,10000,50000),limits=c(0.005,1000))+ ylim(0.2*100,0.8*100) +
annotation_logticks(sides = "b")+
guides(fill="none",linetype="none",shape="none") +
facet_wrap(~species)
pA
jpeg(paste(path_pannel,"pS9A.jpg",sep=""),  width = 10500/2,  5400/2,res=600/1.8)
print(pA)
dev.off()
# Figure 4
imgA = load.image(paste(path_pannel,"pS9A.jpg",sep="") )
{
pdf(file= paste(path_figure,"Figure9_supp.pdf",sep=""), width=9, height=5)
m = matrix(rep(NA,100*100), nrow=100)
m
par(mar=c(1, 1, 2, 0))
plot(imgA, axes=FALSE)
dev.off()
}
>>>>>>> 212c8cde9d8c6e686c6d6532e13a03b976d28e54
